
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>docker安装使用 · liqianlong's book</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="liqianlong">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="k8s_jieshao_deploy.html" />
    
    
    <link rel="prev" href="./" />
    

    
        <link rel="shortcut icon" href='../gitbook/images/favicon.ico' type="image/x-icon">
    
    
        <link rel="bookmark" href='../gitbook/images/favicon.ico' type="image/x-icon">
    
    
        <link rel="apple-touch-icon" href='../gitbook/images/apple-touch-icon.jpg'>
    
    
        
        <link rel="apple-touch-icon" sizes="120x120" href="../gitbook/images/apple-touch-icon.jpg">
        
        <link rel="apple-touch-icon" sizes="180x180" href="../gitbook/images/apple-touch-icon.jpg">
        
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    关于本书
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="./">
            
                <a href="./">
            
                    
                    Kubernetes
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="2.1.1" data-path="docker_install_use.html">
            
                <a href="docker_install_use.html">
            
                    
                    docker安装使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="k8s_jieshao_deploy.html">
            
                <a href="k8s_jieshao_deploy.html">
            
                    
                    k8s介绍部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="k8s_kubectl.html">
            
                <a href="k8s_kubectl.html">
            
                    
                    kubectl命令行
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="k8s_rumen.html">
            
                <a href="k8s_rumen.html">
            
                    
                    k8s入门
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="k8s_jinjie.html">
            
                <a href="k8s_jinjie.html">
            
                    
                    k8s进阶
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../problem/">
            
                <a href="../problem/">
            
                    
                    问题总结
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../problem/apple_drop_notice.html">
            
                <a href="../problem/apple_drop_notice.html">
            
                    
                    苹果掉单通知
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../soft/">
            
                <a href="../soft/">
            
                    
                    软件使用说明
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="../soft/get_baidutongji_report.html">
            
                <a href="../soft/get_baidutongji_report.html">
            
                    
                    获取百度统计报告
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="../soft/sublime_install_use.html">
            
                <a href="../soft/sublime_install_use.html">
            
                    
                    sublime安装使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="../soft/postman_install_use.html">
            
                <a href="../soft/postman_install_use.html">
            
                    
                    postman安装使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.4" data-path="../soft/management_time.html">
            
                <a href="../soft/management_time.html">
            
                    
                    时间管理方法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >docker安装使用</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#&#x5B66;&#x4E60;&#x524D;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;"><b>1. </b>&#x5B66;&#x4E60;&#x524D;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;</a></li><li><span class="title-icon "></span><a href="#docker&#x662F;&#x4EC0;&#x4E48;"><b>2. </b>docker&#x662F;&#x4EC0;&#x4E48;</a></li><ul><li><span class="title-icon "></span><a href="#docker&#x5185;&#x90E8;&#x7EC4;&#x4EF6;"><b>2.1. </b>docker&#x5185;&#x90E8;&#x7EC4;&#x4EF6;</a></li><li><span class="title-icon "></span><a href="#docker&#x8BBE;&#x8BA1;&#x76EE;&#x6807;"><b>2.2. </b>docker&#x8BBE;&#x8BA1;&#x76EE;&#x6807;</a></li><li><span class="title-icon "></span><a href="#docker&#x57FA;&#x672C;&#x7EC4;&#x6210;"><b>2.3. </b>docker&#x57FA;&#x672C;&#x7EC4;&#x6210;</a></li><li><span class="title-icon "></span><a href="#&#x5BB9;&#x5668;&#x5BF9;&#x6BD4;&#x865A;&#x62DF;&#x673A;"><b>2.4. </b>&#x5BB9;&#x5668;&#x5BF9;&#x6BD4;&#x865A;&#x62DF;&#x673A;</a></li><li><span class="title-icon "></span><a href="#docker&#x5E94;&#x7528;&#x573A;&#x666F;"><b>2.5. </b>docker&#x5E94;&#x7528;&#x573A;&#x666F;</a></li></ul><li><span class="title-icon "></span><a href="#linux&#x5B89;&#x88C5;docker-&#x672C;&#x6B21;&#x7248;&#x672C;1903"><b>3. </b>Linux&#x5B89;&#x88C5;docker (&#x672C;&#x6B21;&#x7248;&#x672C;19.03)</a></li><ul><li><span class="title-icon "></span><a href="#&#x5378;&#x8F7D;&#x8001;&#x7684;&#x7248;&#x672C;"><b>3.1. </b>&#x5378;&#x8F7D;&#x8001;&#x7684;&#x7248;&#x672C;</a></li><li><span class="title-icon "></span><a href="#centos7x&#x5B89;&#x88C5;docker"><b>3.2. </b>Centos7.x&#x5B89;&#x88C5;docker</a></li></ul><li><span class="title-icon "></span><a href="#&#x955C;&#x50CF;&#x7BA1;&#x7406;"><b>4. </b>&#x955C;&#x50CF;&#x7BA1;&#x7406;</a></li><ul><li><span class="title-icon "></span><a href="#&#x955C;&#x50CF;&#x662F;&#x4EC0;&#x4E48;"><b>4.1. </b>&#x955C;&#x50CF;&#x662F;&#x4EC0;&#x4E48;</a></li><li><span class="title-icon "></span><a href="#&#x955C;&#x50CF;&#x4E0E;&#x5BB9;&#x5668;&#x8054;&#x7CFB;"><b>4.2. </b>&#x955C;&#x50CF;&#x4E0E;&#x5BB9;&#x5668;&#x8054;&#x7CFB;</a></li><li><span class="title-icon "></span><a href="#&#x7BA1;&#x7406;&#x547D;&#x4EE4;"><b>4.3. </b>&#x7BA1;&#x7406;&#x547D;&#x4EE4;</a></li></ul><li><span class="title-icon "></span><a href="#&#x5BB9;&#x5668;&#x7BA1;&#x7406;"><b>5. </b>&#x5BB9;&#x5668;&#x7BA1;&#x7406;</a></li><ul><li><span class="title-icon "></span><a href="#&#x521B;&#x5EFA;&#x5BB9;&#x5668;"><b>5.1. </b>&#x521B;&#x5EFA;&#x5BB9;&#x5668;</a></li><li><span class="title-icon "></span><a href="#&#x7BA1;&#x7406;&#x547D;&#x4EE4;_1"><b>5.2. </b>&#x7BA1;&#x7406;&#x547D;&#x4EE4;</a></li></ul><li><span class="title-icon "></span><a href="#&#x6570;&#x636E;&#x7BA1;&#x7406;"><b>6. </b>&#x6570;&#x636E;&#x7BA1;&#x7406;</a></li><ul><li><span class="title-icon "></span><a href="#volume"><b>6.1. </b>Volume</a></li><li><span class="title-icon "></span><a href="#bind-mounts"><b>6.2. </b>bind mounts</a></li></ul><li><span class="title-icon "></span><a href="#&#x7F51;&#x7EDC;&#x6A21;&#x5F0F;"><b>7. </b>&#x7F51;&#x7EDC;&#x6A21;&#x5F0F;</a></li><ul><li><span class="title-icon "></span><a href="#&#x5BB9;&#x5668;&#x7F51;&#x7EDC;&#x8BBF;&#x95EE;&#x539F;&#x7406;"><b>7.1. </b>&#x5BB9;&#x5668;&#x7F51;&#x7EDC;&#x8BBF;&#x95EE;&#x539F;&#x7406;</a></li><li><span class="title-icon "></span><a href="#&#x7BA1;&#x7406;&#x547D;&#x4EE4;_2"><b>7.2. </b>&#x7BA1;&#x7406;&#x547D;&#x4EE4;</a></li></ul><li><span class="title-icon "></span><a href="#dockerfile"><b>8. </b>dockerfile</a></li><ul><li><span class="title-icon "></span><a href="#dockerfile&#x683C;&#x5F0F;"><b>8.1. </b>Dockerfile&#x683C;&#x5F0F;</a></li><li><span class="title-icon "></span><a href="#dockerfile&#x6307;&#x4EE4;"><b>8.2. </b>Dockerfile&#x6307;&#x4EE4;</a></li><li><span class="title-icon "></span><a href="#build&#x955C;&#x50CF;"><b>8.3. </b>Build&#x955C;&#x50CF;</a></li><li><span class="title-icon "></span><a href="#&#x6784;&#x5EFA;nginx&#xFF0C;php&#xFF0C;tomcat&#x57FA;&#x7840;&#x955C;&#x50CF;"><b>8.4. </b>&#x6784;&#x5EFA;Nginx&#xFF0C;PHP&#xFF0C;Tomcat&#x57FA;&#x7840;&#x955C;&#x50CF;</a></li><ul><li><span class="title-icon "></span><a href="#&#x6784;&#x5EFA;php&#x57FA;&#x7840;&#x955C;&#x50CF;"><b>8.4.1. </b>&#x6784;&#x5EFA;PHP&#x57FA;&#x7840;&#x955C;&#x50CF;</a></li><li><span class="title-icon "></span><a href="#&#x6784;&#x5EFA;nginx&#x57FA;&#x7840;&#x955C;&#x50CF;"><b>8.4.2. </b>&#x6784;&#x5EFA;Nginx&#x57FA;&#x7840;&#x955C;&#x50CF;</a></li><li><span class="title-icon "></span><a href="#&#x6784;&#x5EFA;tomcat&#x57FA;&#x7840;&#x955C;&#x50CF;"><b>8.4.3. </b>&#x6784;&#x5EFA;tomcat&#x57FA;&#x7840;&#x955C;&#x50CF;</a></li></ul><li><span class="title-icon "></span><a href="#&#x5FEB;&#x901F;&#x90E8;&#x7F72;lnmp&#x7F51;&#x7AD9;&#x5E73;&#x53F0;"><b>8.5. </b>&#x5FEB;&#x901F;&#x90E8;&#x7F72;LNMP&#x7F51;&#x7AD9;&#x5E73;&#x53F0;</a></li></ul><li><span class="title-icon "></span><a href="#&#x4F01;&#x4E1A;&#x7EA7;&#x955C;&#x50CF;&#x4ED3;&#x5E93;harbor"><b>9. </b>&#x4F01;&#x4E1A;&#x7EA7;&#x955C;&#x50CF;&#x4ED3;&#x5E93;harbor</a></li><ul><li><span class="title-icon "></span><a href="#harbor&#x5B89;&#x88C5;"><b>9.1. </b>Harbor&#x5B89;&#x88C5;</a></li><li><span class="title-icon "></span><a href="#&#x57FA;&#x672C;&#x4F7F;&#x7528;"><b>9.2. </b>&#x57FA;&#x672C;&#x4F7F;&#x7528;</a></li></ul><li><span class="title-icon "></span><a href="#&#x57FA;&#x4E8E;docker&#x6784;&#x5EFA;&#x4F01;&#x4E1A;jenkins-ci&#x5E73;&#x53F0;"><b>10. </b>&#x57FA;&#x4E8E;Docker&#x6784;&#x5EFA;&#x4F01;&#x4E1A;Jenkins CI&#x5E73;&#x53F0;</a></li><ul><li><span class="title-icon "></span><a href="#&#x4EC0;&#x4E48;&#x662F;cicd"><b>10.1. </b>&#x4EC0;&#x4E48;&#x662F;CI/CD</a></li><li><span class="title-icon "></span><a href="#ci&#x6D41;&#x7A0B;"><b>10.2. </b>CI&#x6D41;&#x7A0B;</a></li><li><span class="title-icon "></span><a href="#3-10&#x90E8;&#x7F72;"><b>10.3. </b>3-10&#x90E8;&#x7F72;</a></li><li><span class="title-icon "></span><a href="#10101020tomcatmavenjdk&#x5B89;&#x88C5;&#x7565;"><b>10.4. </b>10.10.10.20(tomcat,maven,jdk&#x5B89;&#x88C5;&#x7565;)</a></li><li><span class="title-icon "></span><a href="#10101020jenkins&#x5B89;&#x88C5;&#x7565;&#x63D2;&#x4EF6;git-pipeline"><b>10.5. </b>10.10.10.20(jenkins&#x5B89;&#x88C5;&#x7565;,&#x63D2;&#x4EF6;git pipeline)</a></li><li><span class="title-icon "></span><a href="#10101020hosts"><b>10.6. </b>10.10.10.20(hosts)</a></li><li><span class="title-icon "></span><a href="#10101020&#x521B;&#x5EFA;&#x6D41;&#x6C34;&#x7EBF;&#x9879;&#x76EE;"><b>10.7. </b>10.10.10.20&#x521B;&#x5EFA;&#x6D41;&#x6C34;&#x7EBF;&#x9879;&#x76EE;</a></li></ul><li><span class="title-icon "></span><a href="#jar&#x5305;&#x7684;dockerfile"><b>11. </b>Jar&#x5305;&#x7684;Dockerfile</a></li></ul></div><a href="#&#x5B66;&#x4E60;&#x524D;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="&#x5B66;&#x4E60;&#x524D;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;"><a name="&#x5B66;&#x4E60;&#x524D;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;" class="anchor-navigation-ex-anchor" href="#&#x5B66;&#x4E60;&#x524D;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;"><i class="fa fa-link" aria-hidden="true"></i></a>1. &#x5B66;&#x4E60;&#x524D;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;</h1>
<pre><code class="lang-bash">sed -i s/SELINUX=enforcing/SELINUX=disabled/g /etc/sysconfig/selinux &amp;&amp; setenforce 0
systemctl stop firewalld
systemctl <span class="hljs-built_in">disable</span> firewalld
</code></pre>
<h1 id="docker&#x662F;&#x4EC0;&#x4E48;"><a name="docker&#x662F;&#x4EC0;&#x4E48;" class="anchor-navigation-ex-anchor" href="#docker&#x662F;&#x4EC0;&#x4E48;"><i class="fa fa-link" aria-hidden="true"></i></a>2. docker&#x662F;&#x4EC0;&#x4E48;</h1>
<ul>
<li>&#x4F7F;&#x7528;&#x6700;&#x5E7F;&#x6CDB;&#x7684;&#x5F00;&#x6E90;&#x5BB9;&#x5668;&#x5F15;&#x64CE;</li>
<li>&#x4E00;&#x79CD;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7EA7;&#x7684;&#x865A;&#x62DF;&#x5316;&#x6280;&#x672F;</li>
<li>&#x4F9D;&#x8D56;&#x4E8E;Linux&#x5185;&#x6838;&#x7279;&#x6027;:Namespace(&#x8D44;&#x6E90;&#x9694;&#x79BB;)&#x548C;Cgroups(&#x8D44;&#x6E90;&#x9650;&#x5236;)</li>
<li>&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6253;&#x5305;&#x5DE5;&#x5177;</li>
</ul>
<p><a href="docs.docker.com">docker&#x6587;&#x6863;</a>  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <a href="hub.docker.com">docker&#x4ED3;&#x5E93;</a></p>
<h2 id="docker&#x5185;&#x90E8;&#x7EC4;&#x4EF6;"><a name="docker&#x5185;&#x90E8;&#x7EC4;&#x4EF6;" class="anchor-navigation-ex-anchor" href="#docker&#x5185;&#x90E8;&#x7EC4;&#x4EF6;"><i class="fa fa-link" aria-hidden="true"></i></a>2.1. docker&#x5185;&#x90E8;&#x7EC4;&#x4EF6;</h2>
<ul>
<li>namespaces</li>
</ul>
<blockquote>
<p>&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF0C;Linux&#x5185;&#x6838;&#x63D0;&#x4F9B;&#x7684;&#x4E00;&#x79CD;&#x5BF9;&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;&#x9694;&#x79BB;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x4F8B;&#x5982;&#x8FDB;&#x7A0B;&#x3001;&#x7F51;&#x7EDC;&#x3001;&#x6302;&#x8F7D;&#x70B9;&#x7B49;&#x8D44;&#x6E90;</p>
</blockquote>
<ul>
<li>cgroups</li>
</ul>
<blockquote>
<p>&#x63A7;&#x5236;&#x7EC4;&#xFF0C;Linux&#x5185;&#x6838;&#x63D0;&#x4F9B;&#x7684;&#x4E00;&#x79CD;&#x9650;&#x5236;&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;&#x7684;&#x673A;&#x5236;&#xFF1B;&#x4F8B;&#x5982;CPU&#x3001;&#x5185;&#x5B58;&#x7B49;&#x8D44;&#x6E90;</p>
</blockquote>
<ul>
<li>unionfs</li>
</ul>
<blockquote>
<p>&#x8054;&#x5408;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x652F;&#x6301;&#x5C06;&#x4E0D;&#x540C;&#x4F4D;&#x7F6E;&#x7684;&#x76EE;&#x5F55;&#x6302;&#x8F7D;&#x5230;&#x540C;&#x4E00;&#x865A;&#x62DF;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x5F62;&#x6210;&#x4E00;&#x79CD;&#x5206;&#x5C42;&#x7684;&#x6A21;&#x578B;</p>
</blockquote>
<h2 id="docker&#x8BBE;&#x8BA1;&#x76EE;&#x6807;"><a name="docker&#x8BBE;&#x8BA1;&#x76EE;&#x6807;" class="anchor-navigation-ex-anchor" href="#docker&#x8BBE;&#x8BA1;&#x76EE;&#x6807;"><i class="fa fa-link" aria-hidden="true"></i></a>2.2. docker&#x8BBE;&#x8BA1;&#x76EE;&#x6807;</h2>
<ul>
<li>&#x63D0;&#x4F9B;&#x7B80;&#x5355;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6253;&#x5305;&#x5DE5;&#x5177;</li>
<li>&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x548C;&#x8FD0;&#x7EF4;&#x4EBA;&#x5458;&#x804C;&#x8D23;&#x903B;&#x8F91;&#x5206;&#x79BB;</li>
<li>&#x591A;&#x73AF;&#x5883;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#x6027;</li>
</ul>
<h2 id="docker&#x57FA;&#x672C;&#x7EC4;&#x6210;"><a name="docker&#x57FA;&#x672C;&#x7EC4;&#x6210;" class="anchor-navigation-ex-anchor" href="#docker&#x57FA;&#x672C;&#x7EC4;&#x6210;"><i class="fa fa-link" aria-hidden="true"></i></a>2.3. docker&#x57FA;&#x672C;&#x7EC4;&#x6210;</h2>
<ul>
<li>Docker Client:&#x5BA2;&#x6237;&#x7AEF;</li>
<li>Ddocker Daemon:&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;</li>
<li>Docker Images:&#x955C;&#x50CF;</li>
<li>Docker Container:&#x5BB9;&#x5668;</li>
<li>Docker Registry:&#x955C;&#x50CF;&#x4ED3;&#x5E93;</li>
</ul>
<p><img src="https://www.liqianlong.cn/jibenzucheng.png" alt="image"></p>
<h2 id="&#x5BB9;&#x5668;&#x5BF9;&#x6BD4;&#x865A;&#x62DF;&#x673A;"><a name="&#x5BB9;&#x5668;&#x5BF9;&#x6BD4;&#x865A;&#x62DF;&#x673A;" class="anchor-navigation-ex-anchor" href="#&#x5BB9;&#x5668;&#x5BF9;&#x6BD4;&#x865A;&#x62DF;&#x673A;"><i class="fa fa-link" aria-hidden="true"></i></a>2.4. &#x5BB9;&#x5668;&#x5BF9;&#x6BD4;&#x865A;&#x62DF;&#x673A;</h2>
<p><img src="https://www.liqianlong.cn/rongqivsxuniji1.png" alt="image"></p>
<p><img src="https://www.liqianlong.cn/rongqivsxuniji2.png" alt="image"></p>
<h2 id="docker&#x5E94;&#x7528;&#x573A;&#x666F;"><a name="docker&#x5E94;&#x7528;&#x573A;&#x666F;" class="anchor-navigation-ex-anchor" href="#docker&#x5E94;&#x7528;&#x573A;&#x666F;"><i class="fa fa-link" aria-hidden="true"></i></a>2.5. docker&#x5E94;&#x7528;&#x573A;&#x666F;</h2>
<ul>
<li>&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6253;&#x5305;&#x548C;&#x53D1;&#x5E03;</li>
<li>&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9694;&#x79BB;</li>
<li>&#x6301;&#x7EED;&#x96C6;&#x6210;</li>
<li>&#x90E8;&#x7F72;&#x5FAE;&#x670D;&#x52A1;</li>
<li>&#x5FEB;&#x901F;&#x642D;&#x5EFA;&#x6D4B;&#x8BD5;&#x73AF;&#x5883;</li>
<li>&#x63D0;&#x4F9B;PaaS&#x4EA7;&#x54C1;(&#x5E73;&#x53F0;&#x5373;&#x670D;&#x52A1;)</li>
</ul>
<h1 id="linux&#x5B89;&#x88C5;docker-&#x672C;&#x6B21;&#x7248;&#x672C;1903"><a name="linux&#x5B89;&#x88C5;docker-&#x672C;&#x6B21;&#x7248;&#x672C;1903" class="anchor-navigation-ex-anchor" href="#linux&#x5B89;&#x88C5;docker-&#x672C;&#x6B21;&#x7248;&#x672C;1903"><i class="fa fa-link" aria-hidden="true"></i></a>3. Linux&#x5B89;&#x88C5;docker (&#x672C;&#x6B21;&#x7248;&#x672C;19.03)</h1>
<ul>
<li>&#x793E;&#x533A;&#x7248;(Community Edition&#xFF0C;CE)</li>
<li>&#x4F01;&#x4E1A;&#x7248;(Enterprise Edition&#xFF0C;EE)</li>
</ul>
<h2 id="&#x5378;&#x8F7D;&#x8001;&#x7684;&#x7248;&#x672C;"><a name="&#x5378;&#x8F7D;&#x8001;&#x7684;&#x7248;&#x672C;" class="anchor-navigation-ex-anchor" href="#&#x5378;&#x8F7D;&#x8001;&#x7684;&#x7248;&#x672C;"><i class="fa fa-link" aria-hidden="true"></i></a>3.1. &#x5378;&#x8F7D;&#x8001;&#x7684;&#x7248;&#x672C;</h2>
<pre><code class="lang-bash">yum remove docker \
docker-client \
docker-client-latest \
docker-common \
docker-latest \
docker-latest-logrotate \
docker-logrotate \
docker-selinux \
docker-engine-selinux \
docker-engine
</code></pre>
<h2 id="centos7x&#x5B89;&#x88C5;docker"><a name="centos7x&#x5B89;&#x88C5;docker" class="anchor-navigation-ex-anchor" href="#centos7x&#x5B89;&#x88C5;docker"><i class="fa fa-link" aria-hidden="true"></i></a>3.2. Centos7.x&#x5B89;&#x88C5;docker</h2>
<pre><code class="lang-bash">&#x5B89;&#x88C5;&#x4F9D;&#x8D56;&#x5305;
yum install -y yum-utils device-mapper-persistent-data lvm2
&#x6DFB;&#x52A0;Docker&#x8F6F;&#x4EF6;&#x5305;&#x6E90;
yum-config-manager \
--add-repo \
https://download.docker.com/linux/centos/docker-ce.repo
&#x5907;&#x7528;&#x6E90;
https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/docker-ce.repo
https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
&#x5B89;&#x88C5;Docker CE
yum install -y docker-ce
&#x542F;&#x52A8;Docker&#x670D;&#x52A1;&#x5E76;&#x8BBE;&#x7F6E;&#x5F00;&#x673A;&#x542F;&#x52A8;
systemctl start docker 
systemctl <span class="hljs-built_in">enable</span> docker
</code></pre>
<p>&#x53C2;&#x8003;
<a href="https://docs.docker.com/engine/install/centos/" target="_blank">https://docs.docker.com/engine/install/centos/</a></p>
<p>&#x4E8C;&#x8FDB;&#x5236;&#x5305;&#xFF1A;
<a href="https://download.docker.com/linux/static/stable/x86_64/" target="_blank">https://download.docker.com/linux/static/stable/x86_64/</a></p>
<h1 id="&#x955C;&#x50CF;&#x7BA1;&#x7406;"><a name="&#x955C;&#x50CF;&#x7BA1;&#x7406;" class="anchor-navigation-ex-anchor" href="#&#x955C;&#x50CF;&#x7BA1;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>4. &#x955C;&#x50CF;&#x7BA1;&#x7406;</h1>
<h2 id="&#x955C;&#x50CF;&#x662F;&#x4EC0;&#x4E48;"><a name="&#x955C;&#x50CF;&#x662F;&#x4EC0;&#x4E48;" class="anchor-navigation-ex-anchor" href="#&#x955C;&#x50CF;&#x662F;&#x4EC0;&#x4E48;"><i class="fa fa-link" aria-hidden="true"></i></a>4.1. &#x955C;&#x50CF;&#x662F;&#x4EC0;&#x4E48;</h2>
<ul>
<li>&#x4E00;&#x4E2A;&#x5206;&#x5C42;&#x5B58;&#x50A8;&#x7684;&#x6587;&#x4EF6;</li>
<li>&#x4E00;&#x4E2A;&#x8F6F;&#x4EF6;&#x7684;&#x73AF;&#x5883;</li>
<li>&#x4E00;&#x4E2A;&#x955C;&#x50CF;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;N&#x4E2A;&#x5BB9;&#x5668;</li>
<li>&#x4E00;&#x79CD;&#x6807;&#x51C6;&#x5316;&#x7684;&#x4EA4;&#x4ED8;</li>
<li>&#x4E00;&#x4E2A;&#x4E0D;&#x5305;&#x542B;Linux&#x5185;&#x6838;&#x800C;&#x53C8;&#x7CBE;&#x7B80;&#x7684;Linux&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;</li>
</ul>
<blockquote>
<p>&#x955C;&#x50CF;&#x4ECE;&#x54EA;&#x91CC;&#x6765;?
Docker Hub&#x662F;&#x7531;Docker&#x516C;&#x53F8;&#x8D1F;&#x8D23;&#x7EF4;&#x62A4;&#x7684;&#x516C;&#x5171;&#x6CE8;&#x518C;&#x4E2D;&#x5FC3;&#xFF0C;&#x5305;&#x542B;&#x5927;&#x91CF;&#x7684;&#x5BB9;&#x5668;&#x955C;&#x50CF;&#xFF0C;Docker&#x5DE5;&#x5177;&#x9ED8;&#x8BA4;&#x4ECE;&#x8FD9;&#x4E2A;&#x516C;&#x5171;&#x955C;&#x50CF;&#x5E93;&#x4E0B;&#x8F7D;&#x955C;&#x50CF;&#x3002; &#x5730;&#x5740;:<a href="https://hub.docker.com/explor&#x3002;" target="_blank">https://hub.docker.com/explor&#x3002;</a>
&#x4E0B;&#x9762;&#x662F;&#x914D;&#x7F6E;&#x56FD;&#x5185;&#x955C;&#x50CF;&#x6E90;&#x3002;</p>
</blockquote>
<pre><code class="lang-bash">&#x914D;&#x7F6E;&#x955C;&#x50CF;&#x52A0;&#x901F;&#x5668;:https://www.daocloud.io/mirror
curl <span class="hljs-_">-s</span>SL https://get.daocloud.io/daotools/set_mirror.sh | sh <span class="hljs-_">-s</span> http://f1361db2.m.daocloud.io
&#x6216;&#x8005;&#x624B;&#x52A8;&#x914D;&#x7F6E;
vi /etc/docker/daemon.json 
{
<span class="hljs-string">&quot;registry-mirrors&quot;</span>: [ <span class="hljs-string">&quot;http://f1361db2.m.daocloud.io&quot;</span>]
}
</code></pre>
<h2 id="&#x955C;&#x50CF;&#x4E0E;&#x5BB9;&#x5668;&#x8054;&#x7CFB;"><a name="&#x955C;&#x50CF;&#x4E0E;&#x5BB9;&#x5668;&#x8054;&#x7CFB;" class="anchor-navigation-ex-anchor" href="#&#x955C;&#x50CF;&#x4E0E;&#x5BB9;&#x5668;&#x8054;&#x7CFB;"><i class="fa fa-link" aria-hidden="true"></i></a>4.2. &#x955C;&#x50CF;&#x4E0E;&#x5BB9;&#x5668;&#x8054;&#x7CFB;</h2>
<p><img src="https://www.liqianlong.cn/jingxiangrongqi.png" alt="image"></p>
<blockquote>
<p>&#x5982;&#x56FE;&#xFF0C;&#x5BB9;&#x5668;&#x5176;&#x5B9E;&#x662F;&#x5728;&#x955C;&#x50CF;&#x7684;&#x6700;&#x4E0A;&#x9762;&#x52A0;&#x4E86;&#x4E00;&#x5C42;&#x8BFB;&#x5199;&#x5C42;&#xFF0C;&#x5728;&#x8FD0;&#x884C;&#x5BB9;&#x5668;&#x91CC;&#x6587;&#x4EF6;&#x6539;&#x52A8;&#x65F6;&#xFF0C; &#x4F1A;&#x5148;&#x4ECE;&#x955C;&#x50CF;&#x91CC;&#x8981;&#x5199;&#x7684;&#x6587;&#x4EF6;&#x590D;&#x5236;&#x5230;&#x5BB9;&#x5668;&#x81EA;&#x5DF1;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;(&#x8BFB;&#x5199;&#x5C42;)&#x3002; &#x5982;&#x679C;&#x5BB9;&#x5668;&#x5220;&#x9664;&#x4E86;&#xFF0C;&#x6700;&#x4E0A;&#x9762;&#x7684;&#x8BFB;&#x5199;&#x5C42;&#x4E5F;&#x5C31;&#x5220;&#x9664;&#x4E86;&#xFF0C;&#x6539;&#x52A8;&#x4E5F;&#x5C31;&#x4E22;&#x5931;&#x4E86;&#x3002;&#x6240;&#x4EE5;&#x65E0;&#x8BBA;&#x591A; &#x5C11;&#x4E2A;&#x5BB9;&#x5668;&#x5171;&#x4EAB;&#x4E00;&#x4E2A;&#x955C;&#x50CF;&#xFF0C;&#x6240;&#x505A;&#x7684;&#x5199;&#x64CD;&#x4F5C;&#x90FD;&#x662F;&#x4ECE;&#x955C;&#x50CF;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#x590D;&#x5236;&#x8FC7;&#x6765;&#x64CD;&#x4F5C; &#x7684;&#xFF0C;&#x5E76;&#x4E0D;&#x4F1A;&#x4FEE;&#x6539;&#x955C;&#x50CF;&#x7684;&#x6E90;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x63D0;&#x9AD8;&#x78C1;&#x76D8;&#x5229;&#x7528;&#x7387;&#x3002; &#x82E5;&#x60F3;&#x6301;&#x4E45;&#x5316;&#x8FD9;&#x4E9B;&#x6539;&#x52A8;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;docker commit &#x5C06;&#x5BB9;&#x5668;&#x4FDD;&#x5B58;&#x6210;&#x4E00;&#x4E2A;&#x65B0;&#x955C;&#x50CF;&#x3002;</p>
<ul>
<li>&#x4E00;&#x4E2A;&#x955C;&#x50CF;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x5BB9;&#x5668;</li>
<li>&#x955C;&#x50CF;&#x589E;&#x91CF;&#x5F0F;&#x5B58;&#x50A8;</li>
<li>&#x521B;&#x5EFA;&#x7684;&#x5BB9;&#x5668;&#x91CC;&#x9762;&#x4FEE;&#x6539;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x955C;&#x50CF;</li>
</ul>
</blockquote>
<h2 id="&#x7BA1;&#x7406;&#x547D;&#x4EE4;"><a name="&#x7BA1;&#x7406;&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#&#x7BA1;&#x7406;&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>4.3. &#x7BA1;&#x7406;&#x547D;&#x4EE4;</h2>
<table>
<thead>
<tr>
<th>&#x6307;&#x4EE4;</th>
<th>&#x63CF;&#x8FF0;</th>
</tr>
</thead>
<tbody>
<tr>
<td>ls</td>
<td>&#x5217;&#x51FA;&#x955C;&#x50CF;</td>
</tr>
<tr>
<td>build</td>
<td>&#x6784;&#x5EFA;&#x955C;&#x50CF;&#x6765;&#x81EA;Dockerfile</td>
</tr>
<tr>
<td>history</td>
<td>&#x67E5;&#x770B;&#x955C;&#x50CF;&#x5386;&#x53F2;</td>
</tr>
<tr>
<td>inspect</td>
<td>&#x663E;&#x793A;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x955C;&#x50CF;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;</td>
</tr>
<tr>
<td>pull</td>
<td>&#x4ECE;&#x955C;&#x50CF;&#x4ED3;&#x5E93;&#x62C9;&#x53D6;&#x955C;&#x50CF;</td>
</tr>
<tr>
<td>push</td>
<td>&#x63A8;&#x9001;&#x4E00;&#x4E2A;&#x955C;&#x50CF;&#x5230;&#x955C;&#x50CF;&#x4ED3;&#x5E93;</td>
</tr>
<tr>
<td>rm</td>
<td>&#x79FB;&#x9664;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x955C;&#x50CF;</td>
</tr>
<tr>
<td>prune</td>
<td>&#x79FB;&#x9664;&#x672A;&#x4F7F;&#x7528;&#x7684;&#x955C;&#x50CF;&#x3002;&#x6CA1;&#x6709;&#x88AB;&#x6807;&#x8BB0;&#x6216;&#x88AB;&#x4EFB;&#x4F55;&#x5BB9;&#x5668;&#x5F15;&#x7528;&#x7684;&#x3002;</td>
</tr>
<tr>
<td>tag</td>
<td>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x6E90;&#x955C;&#x50CF;&#x6807;&#x8BB0;&#x76EE;&#x6807;&#x955C;&#x50CF;</td>
</tr>
<tr>
<td>export</td>
<td>&#x5BFC;&#x51FA;&#x5BB9;&#x5668;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x5230;tar&#x5F52;&#x6863;&#x6587;&#x4EF6;</td>
</tr>
<tr>
<td>import</td>
<td>&#x5BFC;&#x5165;&#x5BB9;&#x5668;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;tar&#x5F52;&#x6863;&#x6587;&#x4EF6;&#x521B;&#x5EFA;&#x955C;&#x50CF;</td>
</tr>
<tr>
<td>save</td>
<td>&#x4FDD;&#x5B58;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x955C;&#x50CF;&#x5230;&#x4E00;&#x4E2A;tar&#x5F52;&#x6863;&#x6587;&#x4EF6;</td>
</tr>
<tr>
<td>load</td>
<td>&#x52A0;&#x8F7D;&#x955C;&#x50CF;&#x6765;&#x81EA;tar&#x5F52;&#x6863;&#x6216;&#x6807;&#x51C6;&#x8F93;&#x5165;</td>
</tr>
</tbody>
</table>
<pre><code class="lang-bash">&#x5BFC;&#x51FA;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x4F5C;&#x4E3A;&#x955C;&#x50CF;&#xFF08;&#x5BFC;&#x51FA;&#x662F;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x4E0D;&#x5E38;&#x7528;&#xFF09;
docker images <span class="hljs-built_in">export</span> mynginx &gt; mynginx.tar
docker images import mynginx.tar nginx-test

&#x5BFC;&#x51FA;&#x955C;&#x50CF;&#xFF08;&#x79BB;&#x7EBF;&#x4F7F;&#x7528;&#xFF09;
docker images save mynginx &gt; mynginx.tar
docker images load mynginx.tar
</code></pre>
<h1 id="&#x5BB9;&#x5668;&#x7BA1;&#x7406;"><a name="&#x5BB9;&#x5668;&#x7BA1;&#x7406;" class="anchor-navigation-ex-anchor" href="#&#x5BB9;&#x5668;&#x7BA1;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>5. &#x5BB9;&#x5668;&#x7BA1;&#x7406;</h1>
<h2 id="&#x521B;&#x5EFA;&#x5BB9;&#x5668;"><a name="&#x521B;&#x5EFA;&#x5BB9;&#x5668;" class="anchor-navigation-ex-anchor" href="#&#x521B;&#x5EFA;&#x5BB9;&#x5668;"><i class="fa fa-link" aria-hidden="true"></i></a>5.1. &#x521B;&#x5EFA;&#x5BB9;&#x5668;</h2>
<table>
<thead>
<tr>
<th>&#x6307;&#x4EE4;</th>
<th>&#x63CF;&#x8FF0;</th>
</tr>
</thead>
<tbody>
<tr>
<td>-i, --interactive</td>
<td>&#x4EA4;&#x4E92;&#x5F0F; </td>
</tr>
<tr>
<td>-t, --tty</td>
<td>&#x5206;&#x914D;&#x4E00;&#x4E2A;&#x4F2A;&#x7EC8;&#x7AEF; </td>
</tr>
<tr>
<td>-d, --detach</td>
<td>&#x8FD0;&#x884C;&#x5BB9;&#x5668;&#x5230;&#x540E;&#x53F0; </td>
</tr>
<tr>
<td>-e, --env list</td>
<td>&#x8BBE;&#x7F6E;&#x73AF;&#x5883;&#x53D8;&#x91CF; </td>
</tr>
<tr>
<td>-p, --publish list</td>
<td>&#x53D1;&#x5E03;&#x5BB9;&#x5668;&#x7AEF;&#x53E3;&#x5230;&#x4E3B;&#x673A; </td>
</tr>
<tr>
<td>-P, --publish-all</td>
<td>&#x53D1;&#x5E03;&#x5BB9;&#x5668;&#x6240;&#x6709;EXPOSE&#x7684;&#x7AEF;&#x53E3;&#x5230;&#x5BBF;&#x4E3B;&#x673A;&#x968F;&#x673A;&#x7AEF;</td>
</tr>
<tr>
<td>-h, --hostname string</td>
<td>&#x8BBE;&#x7F6E;&#x5BB9;&#x5668;&#x4E3B;&#x673A;&#x540D;</td>
</tr>
<tr>
<td>--ip string</td>
<td>&#x6307;&#x5B9A;&#x5BB9;&#x5668;IP&#xFF0C;&#x53EA;&#x80FD;&#x7528;&#x4E8E;&#x81EA;&#x5B9A;&#x4E49;&#x7F51;&#x7EDC;</td>
</tr>
<tr>
<td>--network</td>
<td>&#x8FDE;&#x63A5;&#x5BB9;&#x5668;&#x5230;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;</td>
</tr>
<tr>
<td>--mount mount</td>
<td>&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x673A;&#x5206;&#x533A;&#x5230;&#x5BB9;&#x5668;</td>
</tr>
<tr>
<td>-v, --volume list</td>
<td>&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x673A;&#x76EE;&#x5F55;&#x5230;&#x5BB9;&#x5668;</td>
</tr>
<tr>
<td>--restart string</td>
<td>&#x5BB9;&#x5668;&#x9000;&#x51FA;&#x65F6;&#x91CD;&#x542F;&#x7B56;&#x7565;&#xFF0C;&#x9ED8;&#x8BA4;no[always&#x3001;on-failure]</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>&#x8D44;&#x6E90;&#x9650;&#x5236;&#x6307;&#x4EE4;</th>
<th>&#x63CF;&#x8FF0;</th>
</tr>
</thead>
<tbody>
<tr>
<td>-m&#xFF0C;--memory</td>
<td>&#x5BB9;&#x5668;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7684;&#x6700;&#x5927;&#x5185;&#x5B58;&#x91CF;</td>
</tr>
<tr>
<td>--memory-swap</td>
<td>&#x5141;&#x8BB8;&#x4EA4;&#x6362;&#x5230;&#x78C1;&#x76D8;&#x7684;&#x5185;&#x5B58;&#x91CF;</td>
</tr>
<tr>
<td>--memory-swappiness=<0-100></0-100></td>
<td>&#x5BB9;&#x5668;&#x4F7F;&#x7528;SWAP&#x5206;&#x533A;&#x4EA4;&#x6362;&#x7684;&#x767E;&#x5206;&#x6BD4;&#xFF08;0-100&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;-1&#xFF09; </td>
</tr>
<tr>
<td>--memory-reservation</td>
<td>&#x5185;&#x5B58;&#x8F6F;&#x9650;&#x5236;&#xFF0C;Docker&#x68C0;&#x6D4B;&#x4E3B;&#x673A;&#x5BB9;&#x5668;&#x4E89;&#x7528;&#x6216;&#x5185;&#x5B58;&#x4E0D;&#x8DB3;&#x65F6;&#x6240;&#x6FC0;&#x6D3B;&#x7684;&#x8F6F;&#x9650;&#x5236;&#xFF0C;&#x4F7F;&#x7528;&#x6B64;&#x9009;&#x9879;&#xFF0C;&#x503C;&#x5FC5;&#x987B;&#x8BBE;&#x7F6E;&#x4F4E;&#x4E8E;&#x2014;memory&#xFF0C;&#x4EE5;&#x4F7F;&#x5176;&#x4F18;&#x5148;</td>
</tr>
<tr>
<td>--oom-kill-disable</td>
<td>&#x5F53;&#x5BBF;&#x4E3B;&#x673A;&#x5185;&#x5B58;&#x4E0D;&#x8DB3;&#x65F6;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x6740;&#x6B7B;&#x5BB9;&#x5668;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;&#x3002;&#x5EFA;&#x8BAE;&#x8BBE;&#x7F6E;&#x4E86;-memory&#x9009;&#x9879;&#x518D;&#x7981;&#x7528;OOM&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x8BBE;&#x7F6E;&#xFF0C;&#x4E3B;&#x673A;&#x53EF;&#x80FD;&#x4F1A;&#x8017;&#x5C3D;&#x5185;&#x5B58;</td>
</tr>
<tr>
<td>--cpus</td>
<td>&#x9650;&#x5236;&#x5BB9;&#x5668;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x591A;&#x5C11;&#x53EF;&#x7528;&#x7684;CPU&#x8D44;&#x6E90;</td>
</tr>
<tr>
<td>--cpuset-cpus</td>
<td>&#x9650;&#x5236;&#x5BB9;&#x5668;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7279;&#x5B9A;&#x7684;CPU</td>
</tr>
<tr>
<td>--cpu-shares</td>
<td>&#x6B64;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;&#x5927;&#x4E8E;&#x6216;&#x5C0F;&#x4E8E;&#x9ED8;&#x8BA4;1024&#x503C;&#xFF0C;&#x4EE5;&#x589E;&#x52A0;&#x6216;&#x51CF;&#x5C11;&#x5BB9;&#x5668;&#x7684;&#x6743;&#x91CD;&#xFF0C;&#x5E76;&#x4F7F;&#x5176;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x4E3B;&#x673A;CPU&#x5468;&#x671F;&#x7684;&#x66F4;&#x5927;&#x6216;&#x66F4;&#x5C0F;&#x6BD4;&#x4F8B;</td>
</tr>
</tbody>
</table>
<p>&#x793A;&#x4F8B;</p>
<pre><code class="lang-bash">&#x5185;&#x5B58;&#x9650;&#x989D;:
&#x5141;&#x8BB8;&#x5BB9;&#x5668;&#x6700;&#x591A;&#x4F7F;&#x7528;500M&#x5185;&#x5B58;&#x548C;100M&#x7684;Swap&#xFF0C;&#x5E76;&#x7981;&#x7528; OOM Killer:
docker run <span class="hljs-_">-d</span> --name nginx03 --memory=<span class="hljs-string">&quot;500m&quot;</span> --memory-swap=<span class="hljs-string">&quot;600m&quot;</span> --oom-kill-disable nginx

CPU&#x9650;&#x989D;:
&#x5141;&#x8BB8;&#x5BB9;&#x5668;&#x6700;&#x591A;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x534A;&#x7684;CPU:
docker run <span class="hljs-_">-d</span> --name nginx04 --cpus=<span class="hljs-string">&quot;1.5&quot;</span> nginx &#x5141;&#x8BB8;&#x5BB9;&#x5668;&#x6700;&#x591A;&#x4F7F;&#x7528;50%&#x7684;CPU:
docker run <span class="hljs-_">-d</span> --name nginx05 --cpus=<span class="hljs-string">&quot;.5&quot;</span> nginx
</code></pre>
<h2 id="&#x7BA1;&#x7406;&#x547D;&#x4EE4;_1"><a name="&#x7BA1;&#x7406;&#x547D;&#x4EE4;_1" class="anchor-navigation-ex-anchor" href="#&#x7BA1;&#x7406;&#x547D;&#x4EE4;_1"><i class="fa fa-link" aria-hidden="true"></i></a>5.2. &#x7BA1;&#x7406;&#x547D;&#x4EE4;</h2>
<table>
<thead>
<tr>
<th>&#x6307;&#x4EE4;</th>
<th>&#x63CF;&#x8FF0;</th>
</tr>
</thead>
<tbody>
<tr>
<td>ls</td>
<td>&#x5217;&#x51FA;&#x5BB9;&#x5668;</td>
</tr>
<tr>
<td>inspect</td>
<td>&#x663E;&#x793A;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5BB9;&#x5668;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;</td>
</tr>
<tr>
<td>attach</td>
<td>&#x9644;&#x52A0;&#x672C;&#x5730;&#x6807;&#x51C6;&#x8F93;&#x5165;&#xFF0C;&#x8F93;&#x51FA;&#x548C;&#x9519;&#x8BEF;&#x5230;&#x4E00;&#x4E2A;&#x8FD0;&#x884C;&#x7684;&#x5BB9;&#x5668;</td>
</tr>
<tr>
<td>exec</td>
<td>&#x5728;&#x8FD0;&#x884C;&#x5BB9;&#x5668;&#x4E2D;&#x6267;&#x884C;&#x547D;&#x4EE4;</td>
</tr>
<tr>
<td>commit</td>
<td>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x955C;&#x50CF;&#x6765;&#x81EA;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;</td>
</tr>
<tr>
<td>cp</td>
<td>&#x62F7;&#x8D1D;&#x6587;&#x4EF6;/&#x6587;&#x4EF6;&#x5939;&#x5230;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;</td>
</tr>
<tr>
<td>logs</td>
<td>&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x65E5;&#x5FD7;</td>
</tr>
<tr>
<td>port</td>
<td>&#x5217;&#x51FA;&#x6216;&#x6307;&#x5B9A;&#x5BB9;&#x5668;&#x7AEF;&#x53E3;&#x6620;&#x5C04;</td>
</tr>
<tr>
<td>stats</td>
<td>&#x663E;&#x793A;&#x5BB9;&#x5668;&#x8D44;&#x6E90;&#x4F7F;&#x7528;&#x7EDF;&#x8BA1;</td>
</tr>
<tr>
<td>top</td>
<td>&#x663E;&#x793A;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x8FD0;&#x884C;&#x7684;&#x8FDB;&#x7A0B;</td>
</tr>
<tr>
<td>update</td>
<td>&#x66F4;&#x65B0;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5BB9;&#x5668;&#x914D;&#x7F6E;</td>
</tr>
<tr>
<td>stop/start</td>
<td>&#x505C;&#x6B62;/&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5BB9;&#x5668;</td>
</tr>
<tr>
<td>rm</td>
<td>&#x5220;&#x9664;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5BB9;&#x5668;</td>
</tr>
</tbody>
</table>
<pre><code class="lang-bash">&#x521B;&#x5EFA;&#x5BB9;&#x5668;
docker container run -it <span class="hljs-_">-d</span> -h mynginx --name mynginx -p 80:80 <span class="hljs-_">-e</span> a=2 nginx
root@mynginx:/<span class="hljs-comment"># echo $a</span>
2

&#x67E5;&#x770B;&#x8D44;&#x6E90;
docker container stats --no-stream mynginx

&#x5BB9;&#x5668;&#x6253;&#x955C;&#x50CF;
docker container commit <span class="hljs-built_in">local</span>:v1.1.1 mynginx

&#x62F7;&#x8D1D;
docker container cp nginx.tar mynginx:/
docker container <span class="hljs-built_in">exec</span> mynginx ls /
nginx.tar

&#x5220;&#x9664;
docker rm <span class="hljs-_">-f</span> $(docker ps -aq)
</code></pre>
<h1 id="&#x6570;&#x636E;&#x7BA1;&#x7406;"><a name="&#x6570;&#x636E;&#x7BA1;&#x7406;" class="anchor-navigation-ex-anchor" href="#&#x6570;&#x636E;&#x7BA1;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>6. &#x6570;&#x636E;&#x7BA1;&#x7406;</h1>
<blockquote>
<p>Docker&#x63D0;&#x4F9B;&#x4E09;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x65B9;&#x5F0F;&#x5C06;&#x6570;&#x636E;&#x4ECE;&#x5BBF;&#x4E3B;&#x673A;&#x6302;&#x8F7D;&#x5230;&#x5BB9;&#x5668;&#x4E2D;&#xFF1A;volumes&#xFF0C;bind mounts&#x548C;tmpfs&#x3002;</p>
</blockquote>
<ul>
<li>volumes&#xFF1A;Docker&#x7BA1;&#x7406;&#x5BBF;&#x4E3B;&#x673A;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF08;/var/lib/docker/volumes&#xFF09;&#x3002;</li>
<li>bind mounts&#xFF1A;&#x53EF;&#x4EE5;&#x5B58;&#x50A8;&#x5728;&#x5BBF;&#x4E3B;&#x673A;&#x7CFB;&#x7EDF;&#x7684;&#x4EFB;&#x610F;&#x4F4D;&#x7F6E;&#x3002;</li>
<li>tmpfs&#xFF1A;&#x6302;&#x8F7D;&#x5B58;&#x50A8;&#x5728;&#x5BBF;&#x4E3B;&#x673A;&#x7CFB;&#x7EDF;&#x7684;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x800C;&#x4E0D;&#x4F1A;&#x5199;&#x5165;&#x5BBF;&#x4E3B;&#x673A;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;</li>
</ul>
<h2 id="volume"><a name="volume" class="anchor-navigation-ex-anchor" href="#volume"><i class="fa fa-link" aria-hidden="true"></i></a>6.1. Volume</h2>
<table>
<thead>
<tr>
<th>&#x6307;&#x4EE4;</th>
<th>&#x63CF;&#x8FF0;</th>
</tr>
</thead>
<tbody>
<tr>
<td>create</td>
<td>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5377;    </td>
</tr>
<tr>
<td>inspect</td>
<td>&#x68C0;&#x67E5;&#x663E;&#x793A;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5377;&#x4E0A;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;    </td>
</tr>
<tr>
<td>ls</td>
<td>&#x5217;&#x8868;&#x5377;     </td>
</tr>
<tr>
<td>prune</td>
<td>&#x5220;&#x9664;&#x6240;&#x6709;&#x672A;&#x4F7F;&#x7528;&#x7684;&#x672C;&#x5730;&#x5377;     </td>
</tr>
<tr>
<td>rm</td>
<td>&#x5220;&#x9664;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5377;</td>
</tr>
</tbody>
</table>
<ul>
<li><p>&#x7BA1;&#x7406;&#x5377;</p>
<pre><code class="lang-bash">docker volume create nginx-vol 
docker volume ls
docker volume inspect nginx-vol
</code></pre>
</li>
<li><p>&#x7528;&#x5377;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;</p>
<pre><code class="lang-bash">docker run <span class="hljs-_">-d</span> --name=nginx-test --mount <span class="hljs-built_in">type</span>=volume,src=nginx-vol,dst=/usr/share/nginx/html nginx 
docker run <span class="hljs-_">-d</span> --name=nginx-test -v nginx-vol:/usr/share/nginx/html nginx
</code></pre>
</li>
<li><p>&#x6E05;&#x7406;</p>
<pre><code class="lang-bash">docker stop nginx-test
docker rm nginx-test
docker volume rm nginx-vol
</code></pre>
</li>
</ul>
<blockquote>
<p>&#x6CE8;&#x610F;&#xFF1A;</p>
<ol>
<li>&#x5982;&#x679C;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x5377;&#xFF0C;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#x3002;</li>
<li>&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;--mount&#xFF0C;&#x66F4;&#x901A;&#x7528;&#x3002;</li>
</ol>
</blockquote>
<h2 id="bind-mounts"><a name="bind-mounts" class="anchor-navigation-ex-anchor" href="#bind-mounts"><i class="fa fa-link" aria-hidden="true"></i></a>6.2. bind mounts</h2>
<ul>
<li>&#x7528;&#x5377;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;:<pre><code class="lang-bash">docker run <span class="hljs-_">-d</span> --name=nginx-test --mount <span class="hljs-built_in">type</span>=<span class="hljs-built_in">bind</span>,src=/app/wwwroot,dst=/usr/share/nginx/html nginx <span class="hljs-comment"># docker run -d --name=nginx-test -v /app/wwwroot:/usr/share/nginx/html nginx</span>
</code></pre>
</li>
<li>&#x9A8C;&#x8BC1;&#x7ED1;&#x5B9A;:<pre><code class="lang-bash">docker inspect nginx-test
</code></pre>
</li>
<li>&#x6E05;&#x7406;:<pre><code class="lang-bash">docker stop nginx-test <span class="hljs-comment"># docker rm nginx-test</span>
</code></pre>
</li>
</ul>
<blockquote>
<p>&#x6CE8;&#x610F;&#xFF1A;</p>
<ol>
<li>&#x5982;&#x679C;&#x6E90;&#x6587;&#x4EF6;/&#x76EE;&#x5F55;&#x6CA1;&#x6709;&#x5B58;&#x5728;&#xFF0C;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#xFF0C;&#x4F1A;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002;&#x6240;&#x4EE5;&#x8981;&#x63D0;&#x524D;&#x521B;&#x5EFA;</li>
<li>&#x5982;&#x679C;&#x6302;&#x8F7D;&#x76EE;&#x6807;&#x5728;&#x5BB9;&#x5668;&#x4E2D;&#x975E;&#x7A7A;&#x76EE;&#x5F55;&#xFF0C;&#x5219;&#x8BE5;&#x76EE;&#x5F55;&#x73B0;&#x6709;&#x5185;&#x5BB9;&#x5C06;&#x88AB;&#x9690;&#x85CF;&#x3002;</li>
</ol>
</blockquote>
<p>Volume&#x7279;&#x70B9;:</p>
<ul>
<li>&#x591A;&#x4E2A;&#x8FD0;&#x884C;&#x5BB9;&#x5668;&#x4E4B;&#x95F4;&#x5171;&#x4EAB;&#x6570;&#x636E;&#xFF0C;&#x591A;&#x4E2A;&#x5BB9;&#x5668;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x6302;&#x8F7D;&#x76F8;&#x540C;&#x7684;&#x5377;&#x3002; </li>
<li>&#x5F53;&#x5BB9;&#x5668;&#x505C;&#x6B62;&#x6216;&#x88AB;&#x79FB;&#x9664;&#x65F6;&#xFF0C;&#x8BE5;&#x5377;&#x4F9D;&#x7136;&#x5B58;&#x5728;&#x3002;</li>
<li>&#x5F53;&#x660E;&#x786E;&#x5220;&#x9664;&#x5377;&#x65F6;&#xFF0C;&#x5377;&#x624D;&#x4F1A;&#x88AB;&#x5220;&#x9664;&#x3002;</li>
<li>&#x5C06;&#x5BB9;&#x5668;&#x7684;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5728;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x6216;&#x5176;&#x4ED6;&#x5B58;&#x50A8;&#x4E0A;(&#x95F4;&#x63A5;)&#x3002;</li>
<li>&#x5C06;&#x6570;&#x636E;&#x4ECE;&#x4E00;&#x53F0;Docker&#x4E3B;&#x673A;&#x8FC1;&#x79FB;&#x5230;&#x53E6;&#x4E00;&#x53F0;&#x65F6;&#xFF0C;&#x5148;&#x505C;&#x6B62;&#x5BB9;&#x5668;&#xFF0C;&#x7136;&#x540E;&#x5907;&#x4EFD;&#x5377;&#x7684;&#x76EE;&#x5F55;(/var/lib/docker/volumes/)&#x3002;</li>
</ul>
<p>Bind Mounts&#x7279;&#x70B9;:</p>
<ul>
<li>&#x4ECE;&#x4E3B;&#x673A;&#x5171;&#x4EAB;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5230;&#x5BB9;&#x5668;&#x3002;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6302;&#x8F7D;&#x4E3B;&#x673A;/etc/resolv.conf&#x5230;&#x6BCF;&#x4E2A;&#x5BB9;&#x5668;&#xFF0C;&#x63D0;&#x4F9B;DNS&#x89E3;&#x6790;&#x3002;</li>
<li>&#x5728;Docker&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x5F00;&#x53D1;&#x73AF;&#x5883;&#x548C;&#x5BB9;&#x5668;&#x4E4B;&#x95F4;&#x5171;&#x4EAB;&#x6E90;&#x4EE3;&#x7801;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;Maven target&#x76EE;&#x5F55;&#x6302;&#x8F7D;&#x5230;&#x5BB9;&#x5668;&#x4E2D;&#xFF0C;&#x6BCF;&#x6B21;&#x5728;Docker&#x4E3B;&#x673A;&#x4E0A;&#x6784;&#x5EFA;Maven&#x9879;&#x76EE;&#x65F6;&#xFF0C;&#x5BB9;&#x5668;&#x90FD;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x6784;&#x5EFA;&#x7684;&#x9879;&#x76EE;&#x5305;&#x3002;</li>
<li>&#x5F53;Docker&#x4E3B;&#x673A;&#x7684;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#x7ED3;&#x6784;&#x4FDD;&#x8BC1;&#x4E0E;&#x5BB9;&#x5668;&#x6240;&#x9700;&#x7684;&#x7ED1;&#x5B9A;&#x6302;&#x8F7D;&#x4E00;&#x81F4;&#x65F6;&#x3002;</li>
</ul>
<h1 id="&#x7F51;&#x7EDC;&#x6A21;&#x5F0F;"><a name="&#x7F51;&#x7EDC;&#x6A21;&#x5F0F;" class="anchor-navigation-ex-anchor" href="#&#x7F51;&#x7EDC;&#x6A21;&#x5F0F;"><i class="fa fa-link" aria-hidden="true"></i></a>7. &#x7F51;&#x7EDC;&#x6A21;&#x5F0F;</h1>
<ul>
<li>bridge<blockquote>
<p>&#x2013;net=bridge <br> &#x9ED8;&#x8BA4;&#x7F51;&#x7EDC;&#xFF0C;Docker&#x542F;&#x52A8;&#x540E;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;docker0&#x7F51;&#x6865;&#xFF0C;&#x9ED8;&#x8BA4;&#x521B;&#x5EFA;&#x7684;&#x5BB9;&#x5668;&#x4E5F;&#x662F;&#x6DFB;&#x52A0;&#x5230;&#x8FD9;&#x4E2A;&#x7F51;&#x6865;&#x4E2D;&#x3002;</p>
</blockquote>
</li>
<li>host<blockquote>
<p>&#x2013;net=host <br> &#x5BB9;&#x5668;&#x4E0D;&#x4F1A;&#x83B7;&#x5F97;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;network namespace&#xFF0C;&#x800C;&#x662F;&#x4E0E;&#x5BBF;&#x4E3B;&#x673A;&#x5171;&#x7528;&#x4E00;&#x4E2A;&#x3002;&#x8FD9;&#x5C31;&#x610F;&#x5473;&#x7740;&#x5BB9;&#x5668;&#x4E0D;&#x4F1A;&#x6709;&#x81EA;&#x5DF1;&#x7684;&#x7F51;&#x5361;&#x4FE1;&#x606F;&#xFF0C;&#x800C;&#x662F;&#x4F7F;&#x7528;&#x5BBF;&#x4E3B;&#x673A;&#x7684;&#x3002;&#x5BB9;&#x5668;&#x9664;&#x4E86;&#x7F51;&#x7EDC;&#xFF0C;&#x5176;&#x4ED6;&#x90FD;&#x662F;&#x9694;&#x79BB;&#x7684;&#x3002;</p>
</blockquote>
</li>
<li>none <br> <blockquote>
<p>&#x2013;net=none <br> &#x83B7;&#x53D6;&#x72EC;&#x7ACB;&#x7684;network namespace&#xFF0C;&#x4F46;&#x4E0D;&#x4E3A;&#x5BB9;&#x5668;&#x8FDB;&#x884C;&#x4EFB;&#x4F55;&#x7F51;&#x7EDC;&#x914D;&#x7F6E;&#xFF0C;&#x9700;&#x8981;&#x6211;&#x4EEC;&#x624B;&#x52A8;&#x914D;&#x7F6E;&#x3002;</p>
</blockquote>
</li>
<li>container <blockquote>
<p>&#x2013;net=container:Name/ID <br> &#x4E0E;&#x6307;&#x5B9A;&#x7684;&#x5BB9;&#x5668;&#x4F7F;&#x7528;&#x540C;&#x4E00;&#x4E2A;network namespace&#xFF0C;&#x5177;&#x6709;&#x540C;&#x6837;&#x7684;&#x7F51;&#x7EDC;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#xFF0C;&#x4E24;&#x4E2A;&#x5BB9;&#x5668;&#x9664;&#x4E86;&#x7F51;&#x7EDC;&#xFF0C;&#x5176;&#x4ED6;&#x90FD;&#x8FD8;&#x662F;&#x9694;&#x79BB;&#x7684;&#x3002;</p>
</blockquote>
</li>
<li>&#x81EA;&#x5B9A;&#x4E49;&#x7F51;&#x7EDC;<blockquote>
<p>&#x4E0E;&#x9ED8;&#x8BA4;&#x7684;bridge&#x539F;&#x7406;&#x4E00;&#x6837;&#xFF0C;&#x4F46;&#x81EA;&#x5B9A;&#x4E49;&#x7F51;&#x7EDC;&#x5177;&#x5907;&#x5185;&#x90E8;DNS&#x53D1;&#x73B0;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5BB9;&#x5668;&#x540D;&#x5BB9;&#x5668;&#x4E4B;&#x95F4;&#x7F51;&#x7EDC;&#x901A;&#x4FE1;&#x3002;</p>
</blockquote>
</li>
</ul>
<h2 id="&#x5BB9;&#x5668;&#x7F51;&#x7EDC;&#x8BBF;&#x95EE;&#x539F;&#x7406;"><a name="&#x5BB9;&#x5668;&#x7F51;&#x7EDC;&#x8BBF;&#x95EE;&#x539F;&#x7406;" class="anchor-navigation-ex-anchor" href="#&#x5BB9;&#x5668;&#x7F51;&#x7EDC;&#x8BBF;&#x95EE;&#x539F;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>7.1. &#x5BB9;&#x5668;&#x7F51;&#x7EDC;&#x8BBF;&#x95EE;&#x539F;&#x7406;</h2>
<p><img src="https://www.liqianlong.cn/rongqiwangluo1.png" alt="image"></p>
<p>eth0&#x4E0E;veth&#x662F;&#x6210;&#x5BF9;&#x51FA;&#x73B0;&#x7684;&#xFF0C;veth&#x5B58;&#x5728;&#x4E8E;&#x5BBF;&#x4E3B;&#x673A;&#x4E0A;&#xFF0C;eth0&#x5728;&#x5BB9;&#x5668;&#x5185;&#xFF0C;&#x5BB9;&#x5668;&#x5185;&#x901A;&#x4FE1;&#x5230;&#x8FBE;eth0--veth&#x6536;&#x5230;&#x901A;&#x4FE1;--&#x53D1;&#x7ED9;docker0&#x7F51;&#x5173;--&#x8FDB;&#x884C;SNAT--&#x5BBF;&#x4E3B;&#x673A;eth0&#x51FA;&#x53BB;&#x4E86;&#x3002;</p>
<p><img src="https://www.liqianlong.cn/rongqiwangluo2.png" alt="image"></p>
<h2 id="&#x7BA1;&#x7406;&#x547D;&#x4EE4;_2"><a name="&#x7BA1;&#x7406;&#x547D;&#x4EE4;_2" class="anchor-navigation-ex-anchor" href="#&#x7BA1;&#x7406;&#x547D;&#x4EE4;_2"><i class="fa fa-link" aria-hidden="true"></i></a>7.2. &#x7BA1;&#x7406;&#x547D;&#x4EE4;</h2>
<table>
<thead>
<tr>
<th>&#x6307;&#x4EE4;</th>
<th>&#x63CF;&#x8FF0;</th>
</tr>
</thead>
<tbody>
<tr>
<td>connect</td>
<td>&#x5C06;&#x5BB9;&#x5668;&#x8FDE;&#x63A5;&#x5230;&#x7F51;&#x7EDC;</td>
</tr>
<tr>
<td>create</td>
<td>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;</td>
</tr>
<tr>
<td>disconnect</td>
<td>&#x65AD;&#x5F00;&#x4ECE;&#x7F51;&#x7EDC;&#x4E0A;&#x65AD;&#x5F00;&#x5BB9;&#x5668;&#x7684;&#x8FDE;&#x63A5;</td>
</tr>
<tr>
<td>inspect</td>
<td>&#x68C0;&#x67E5;&#x5728;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x7F51;&#x7EDC;&#x4E0A;&#x663E;&#x793A;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;</td>
</tr>
<tr>
<td>ls</td>
<td>&#x7F51;&#x7EDC;&#x5217;&#x8868;</td>
</tr>
<tr>
<td>prune</td>
<td>&#x5220;&#x9664;&#x6240;&#x6709;&#x672A;&#x4F7F;&#x7528;&#x7684;&#x7F51;&#x7EDC;</td>
</tr>
<tr>
<td>rm</td>
<td>rm&#x5220;&#x9664;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x7F51;&#x7EDC;</td>
</tr>
</tbody>
</table>
<ul>
<li><p>&#x521B;&#x5EFA;&#x7F51;&#x7EDC;</p>
<pre><code class="lang-bash">docker network create mynet
</code></pre>
</li>
<li><p>&#x521B;&#x5EFA;&#x5BB9;&#x5668;</p>
<pre><code class="lang-bash">docker run -it --rm --name busybox1(2) --network mynet busybox sh
</code></pre>
</li>
<li><p>&#x9A8C;&#x8BC1;</p>
<pre><code class="lang-bash"><span class="hljs-comment"># ping busybox1</span>
PING busybox1 (172.20.0.2): 56 data bytes
64 bytes from 172.20.0.2: seq=0 ttl=64 time=0.125 ms
</code></pre>
</li>
</ul>
<h1 id="dockerfile"><a name="dockerfile" class="anchor-navigation-ex-anchor" href="#dockerfile"><i class="fa fa-link" aria-hidden="true"></i></a>8. dockerfile</h1>
<ol>
<li>Dockerfile&#x683C;&#x5F0F;</li>
<li>Dockerfile&#x6307;&#x4EE4;</li>
<li>Build&#x955C;&#x50CF;</li>
<li>&#x6784;&#x5EFA;Nginx&#xFF0C;PHP&#xFF0C;Tomcat&#x57FA;&#x7840;&#x955C;&#x50CF;</li>
<li>&#x5FEB;&#x901F;&#x642D;&#x5EFA;LNMP&#x7F51;&#x7AD9;&#x5E73;&#x53F0;</li>
</ol>
<h2 id="dockerfile&#x683C;&#x5F0F;"><a name="dockerfile&#x683C;&#x5F0F;" class="anchor-navigation-ex-anchor" href="#dockerfile&#x683C;&#x5F0F;"><i class="fa fa-link" aria-hidden="true"></i></a>8.1. Dockerfile&#x683C;&#x5F0F;</h2>
<p><img src="https://www.liqianlong.cn/dockerfile_geshi.png" alt="image"></p>
<h2 id="dockerfile&#x6307;&#x4EE4;"><a name="dockerfile&#x6307;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#dockerfile&#x6307;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>8.2. Dockerfile&#x6307;&#x4EE4;</h2>
<table>
<thead>
<tr>
<th><div style="width:100px">&#x6307;&#x4EE4;</div></th>
<th>&#x63CF;&#x8FF0; </th>
</tr>
</thead>
<tbody>
<tr>
<td>FROM</td>
<td>&#x6307;&#x5B9A;&#x57FA;&#x7840;&#x955C;&#x50CF; &#x4F8B;&#x5982;&#xFF1A;FROM centos:7</td>
</tr>
<tr>
<td>MAINTAINER</td>
<td>&#x955C;&#x50CF;&#x7EF4;&#x62A4;&#x8005;&#x59D3;&#x540D;&#x6216;&#x90AE;&#x7BB1;&#x5730;&#x5740;&#x4F8B;&#x5982;&#xFF1A;MAINTAINER liqianlong&#xFF0C;&#x4F46;&#x662F;&#x73B0;&#x5728;&#x662F;LABEL maintainer liqianlong</td>
</tr>
<tr>
<td>RUN</td>
<td>&#x7528;&#x6765;&#x6267;&#x884C;&#x547D;&#x4EE4; shell &#x683C;&#x5F0F;&#xFF1A;RUN &lt;&#x547D;&#x4EE4;&gt; <br> exec &#x683C;&#x5F0F;&#xFF1A;RUN [&quot;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&quot;, &quot;&#x53C2;&#x6570;1&quot;, &quot;&#x53C2;&#x6570;2&quot;]</td>
</tr>
<tr>
<td>CMD</td>
<td>&#x8FD0;&#x884C;&#x5BB9;&#x5668;&#x65F6;&#x6267;&#x884C;&#x7684;Shell&#x547D;&#x4EE4; shell &#x683C;&#x5F0F;&#xFF1A;CMD &lt;&#x547D;&#x4EE4;&gt; <br> exec &#x683C;&#x5F0F;&#xFF1A;CMD [&quot;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&quot;, &quot;&#x53C2;&#x6570;1&quot;, &quot;&#x53C2;&#x6570;2&quot;...] <br> shell &#x683C;&#x5F0F;&#x7684;&#x8BDD;&#xFF0C;&#x5B9E;&#x9645;&#x7684;&#x547D;&#x4EE4;&#x4F1A;&#x88AB;&#x5305;&#x88C5;&#x4E3A; sh -c &#x7684;&#x53C2;&#x6570;&#x7684;&#x5F62;&#x5F0F;&#x8FDB;&#x884C;&#x6267;&#x884C; CMD [ &quot;sh&quot;, &quot;-c&quot;, &quot;echo $HOME&quot; ]&#xFF0C;&#x53EA;&#x80FD;&#x4E00;&#x4E2A;</td>
</tr>
<tr>
<td>EXPOSE</td>
<td>&#x58F0;&#x660E;&#x8FD0;&#x884C;&#x65F6;&#x5BB9;&#x5668;&#x63D0;&#x4F9B;&#x670D;&#x52A1;&#x7AEF;&#x53E3;&#xFF1A;EXPOSE 80 443</td>
</tr>
<tr>
<td>ENV</td>
<td>&#x683C;&#x5F0F;&#x6709;&#x4E24;&#x79CD;&#xFF1A;<br> ENV <key> <value> <br> ENV <key1>=<value1> <key2>=<value2>...</value2></key2></value1></key1></value></key></td>
</tr>
<tr>
<td>ADD</td>
<td>&#x5982;&#x679C;&lt;&#x6E90;&#x8DEF;&#x5F84;&gt;&#x4E3A;&#x4E00;&#x4E2A;tar&#x538B;&#x7F29;&#x6587;&#x4EF6;&#x7684;&#x8BDD;&#xFF0C;&#x538B;&#x7F29;&#x683C;&#x5F0F;&#x4E3A;gzip, bzip2&#x4EE5;&#x53CA;xz&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;ADD&#x6307;&#x4EE4;&#x5C06;&#x4F1A;&#x81EA;&#x52A8;&#x89E3;&#x538B;&#x7F29;&#x8FD9;&#x4E2A;&#x538B;&#x7F29;&#x6587;&#x4EF6;&#x5230; &lt;&#x76EE;&#x6807;&#x8DEF;&#x5F84;&gt; &#x53BB;,&#x4E0D;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#x4E86;&#x3002;</td>
</tr>
<tr>
<td>COPY</td>
<td>&#x62F7;&#x8D1D;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#x5230;&#x955C;&#x50CF;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x914D;&#x7B26;&#x3002;&#x7528;&#x6CD5;&#x4F8B;&#x5982;&#xFF1A;COPY hom* /mydir/</td>
</tr>
<tr>
<td>ENTRYPOINT</td>
<td>&#x683C;&#x5F0F;&#x548C;CMD&#x6307;&#x4EE4;&#x683C;&#x5F0F;&#x4E00;&#x6837;,dockerfile&#x91CC;&#x9762;&#x6709;ENTRYPOINT&#x548C;CMD&#x7684;&#x8BDD;&#xFF0C;CMD&#x53C2;&#x6570;&#x4F1A;&#x8FFD;&#x52A0;&#x5230;ENTRYPOINT&#x53C2;&#x6570;&#x7684;&#x540E;&#x9762;&#xFF0C;&#x5728;&#x542F;&#x52A8;&#x5BB9;&#x5668;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5982;&#x679C;&#x7ED9;&#x4E88;&#x547D;&#x4EE4;CMD&#x53C2;&#x6570;&#x5C06;&#x4F1A;&#x88AB;&#x8986;&#x76D6;&#xFF0C;&#x6CE8;&#x610F;dockerfile&#x91CC;&#x9762;ENTRYPOINT&#x53EA;&#x6709;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x751F;&#x6548;</td>
</tr>
<tr>
<td>VOLUME</td>
<td>VOLUME [&quot;&lt;&#x8DEF;&#x5F84;1&gt;&quot;, &quot;&lt;&#x8DEF;&#x5F84;2&gt;&quot;...] <br> VOLUME &lt;&#x8DEF;&#x5F84;&gt;</td>
</tr>
<tr>
<td>WORKDIR</td>
<td>&#x683C;&#x5F0F;&#x4E3A;&#xFF1A;WORKDIR &lt;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x8DEF;&#x5F84;&gt; &#x4F7F;&#x7528;WORKDIR&#x6307;&#x4EE4;&#x53EF;&#x4EE5;&#x6765;&#x6307;&#x5B9A;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#xFF08;&#x6216;&#x8005;&#x79F0;&#x4E3A;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#xFF09;&#xFF0C;&#x4EE5;&#x540E;&#x5404;&#x5C42;&#x7684;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x5C31;&#x88AB;&#x6539;&#x4E3A;&#x6307;&#x5B9A;&#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x5982;&#x8BE5;&#x76EE;&#x5F55;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;WORKDIR&#x4F1A;&#x5E2E;&#x4F60;&#x5EFA;&#x7ACB;&#x76EE;&#x5F55;</td>
</tr>
<tr>
<td>USER</td>
<td>&#x683C;&#x5F0F;&#xFF1A;USER &lt;&#x7528;&#x6237;&#x540D;&gt;[:&lt;&#x7528;&#x6237;&#x7EC4;&gt;],USER&#x6307;&#x4EE4;&#x548C;WORKDIR&#x76F8;&#x4F3C;&#xFF0C;&#x90FD;&#x662F;&#x6539;&#x53D8;&#x73AF;&#x5883;&#x72B6;&#x6001;&#x5E76;&#x5F71;&#x54CD;&#x4EE5;&#x540E;&#x7684;&#x5C42;&#x3002;WORKDIR&#x662F;&#x6539;&#x53D8;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#xFF0C;USER&#x5219;&#x662F;&#x6539;&#x53D8;&#x4E4B;&#x540E;&#x5C42;&#x7684;&#x6267;&#x884C;RUN, CMD&#x4EE5;&#x53CA;ENTRYPOINT&#x8FD9;&#x7C7B;&#x547D;&#x4EE4;&#x7684;&#x8EAB;&#x4EFD;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x548C;WORKDIR&#x4E00;&#x6837;&#xFF0C;USER&#x53EA;&#x662F;&#x5E2E;&#x52A9;&#x4F60;&#x5207;&#x6362;&#x5230;&#x6307;&#x5B9A;&#x7528;&#x6237;&#x800C;&#x5DF2;&#xFF0C;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x5FC5;&#x987B;&#x662F;&#x4E8B;&#x5148;&#x5EFA;&#x7ACB;&#x597D;&#x7684;&#xFF0C;&#x5426;&#x5219;&#x65E0;&#x6CD5;&#x5207;&#x6362;</td>
</tr>
</tbody>
</table>
<h2 id="build&#x955C;&#x50CF;"><a name="build&#x955C;&#x50CF;" class="anchor-navigation-ex-anchor" href="#build&#x955C;&#x50CF;"><i class="fa fa-link" aria-hidden="true"></i></a>8.3. Build&#x955C;&#x50CF;</h2>
<blockquote>
<p>docker build [&#x9009;&#x9879;] &lt;&#x4E0A;&#x4E0B;&#x6587;&#x8DEF;&#x5F84;/URL/-&gt;</p>
</blockquote>
<ul>
<li>-t, --tag list # &#x955C;&#x50CF;&#x540D;&#x79F0;,&#x7248;&#x672C;</li>
<li>-f, --file string # &#x6307;&#x5B9A;Dockerfile&#x6587;&#x4EF6;&#x4F4D;&#x7F6E; </li>
</ul>
<pre><code class="lang-bash">docker build -t nginx:v1 .
.&#x8868;&#x793A;&#xFF0C;&#x5982;&#x679C;dockfile&#x4E2D;&#x7528;&#x5230;&#x4E86;copy&#xFF0C;&#x4EE3;&#x8868;&#x5BB9;&#x5668;&#x5185;&#x76EE;&#x5F55;
</code></pre>
<h2 id="&#x6784;&#x5EFA;nginx&#xFF0C;php&#xFF0C;tomcat&#x57FA;&#x7840;&#x955C;&#x50CF;"><a name="&#x6784;&#x5EFA;nginx&#xFF0C;php&#xFF0C;tomcat&#x57FA;&#x7840;&#x955C;&#x50CF;" class="anchor-navigation-ex-anchor" href="#&#x6784;&#x5EFA;nginx&#xFF0C;php&#xFF0C;tomcat&#x57FA;&#x7840;&#x955C;&#x50CF;"><i class="fa fa-link" aria-hidden="true"></i></a>8.4. &#x6784;&#x5EFA;Nginx&#xFF0C;PHP&#xFF0C;Tomcat&#x57FA;&#x7840;&#x955C;&#x50CF;</h2>
<h3 id="&#x6784;&#x5EFA;php&#x57FA;&#x7840;&#x955C;&#x50CF;"><a name="&#x6784;&#x5EFA;php&#x57FA;&#x7840;&#x955C;&#x50CF;" class="anchor-navigation-ex-anchor" href="#&#x6784;&#x5EFA;php&#x57FA;&#x7840;&#x955C;&#x50CF;"><i class="fa fa-link" aria-hidden="true"></i></a>8.4.1. &#x6784;&#x5EFA;PHP&#x57FA;&#x7840;&#x955C;&#x50CF;</h3>
<pre><code class="lang-bash">FROM centos:7
LABEL maintainer liqianlong
RUN yum install epel-release -y &amp;&amp; \
    yum install -y gcc gcc-c++ make gd-devel libxml2-devel \
    libcurl-devel libjpeg-devel libpng-devel openssl-devel \
    libmcrypt-devel libxslt-devel libtidy-devel autoconf \
    iproute net-tools telnet wget curl &amp;&amp; \
    yum clean all &amp;&amp; \
    rm -rf /var/cache/yum/*

RUN wget http://docs.php.net/distributions/php-5.6.36.tar.gz &amp;&amp; \
<span class="hljs-comment"># COPY php-5.6.36.tar.gz /</span>
RUN tar zxf php-5.6.36.tar.gz &amp;&amp; \
    <span class="hljs-built_in">cd</span> php-5.6.36 &amp;&amp; \
    ./configure --prefix=/usr/<span class="hljs-built_in">local</span>/php \
    --with-config-file-path=/usr/<span class="hljs-built_in">local</span>/php/etc \
    --enable-fpm --enable-opcache \
    --with-mysql --with-mysqli --with-pdo-mysql \
    --with-openssl --with-zlib --with-curl --with-gd \
    --with-jpeg-dir --with-png-dir --with-freetype-dir \
    --enable-mbstring --with-mcrypt --enable-hash &amp;&amp; \
    make -j 2 &amp;&amp; make install &amp;&amp; \
    cp php.ini-production /usr/<span class="hljs-built_in">local</span>/php/etc/php.ini &amp;&amp; \
    cp sapi/fpm/php-fpm.conf /usr/<span class="hljs-built_in">local</span>/php/etc/php-fpm.conf &amp;&amp; \
    sed -i <span class="hljs-string">&quot;90a \daemonize = no&quot;</span> /usr/<span class="hljs-built_in">local</span>/php/etc/php-fpm.conf &amp;&amp; \
    mkdir /usr/<span class="hljs-built_in">local</span>/php/<span class="hljs-built_in">log</span> &amp;&amp; \
    <span class="hljs-built_in">cd</span> / &amp;&amp; rm -rf php* &amp;&amp; \
    ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime

ENV PATH <span class="hljs-variable">$PATH</span>:/usr/<span class="hljs-built_in">local</span>/php/sbin
COPY php.ini /usr/<span class="hljs-built_in">local</span>/php/etc/
COPY php-fpm.conf /usr/<span class="hljs-built_in">local</span>/php/etc/
WORKDIR /usr/<span class="hljs-built_in">local</span>/php
EXPOSE 9000
CMD [<span class="hljs-string">&quot;php-fpm&quot;</span>]
</code></pre>
<ul>
<li>&#x6784;&#x5EFA;&#x955C;&#x50CF;<pre><code class="lang-bash">docker build -t php:v1 Dockerfile-php .
</code></pre>
</li>
</ul>
<h3 id="&#x6784;&#x5EFA;nginx&#x57FA;&#x7840;&#x955C;&#x50CF;"><a name="&#x6784;&#x5EFA;nginx&#x57FA;&#x7840;&#x955C;&#x50CF;" class="anchor-navigation-ex-anchor" href="#&#x6784;&#x5EFA;nginx&#x57FA;&#x7840;&#x955C;&#x50CF;"><i class="fa fa-link" aria-hidden="true"></i></a>8.4.2. &#x6784;&#x5EFA;Nginx&#x57FA;&#x7840;&#x955C;&#x50CF;</h3>
<pre><code class="lang-bash">FROM centos:7
LABEL maintainer liqianlong
RUN yum install -y gcc gcc-c++ make \
    openssl-devel pcre-devel gd-devel \
    iproute net-tools telnet wget curl &amp;&amp; \
    yum clean all &amp;&amp; \
    rm -rf /var/cache/yum/*
<span class="hljs-comment"># COPY nginx-1.15.5.tar.gz /usr/local/src</span>
WORKDIR /usr/<span class="hljs-built_in">local</span>/src
RUN wget http://nginx.org/download/nginx-1.15.5.tar.gz &amp;&amp; \
RUN tar zxf nginx-1.15.5.tar.gz &amp;&amp; \
    <span class="hljs-built_in">cd</span> nginx-1.15.5 &amp;&amp; \
    ./configure --prefix=/usr/<span class="hljs-built_in">local</span>/nginx \
    --with-http_ssl_module \
    --with-http_stub_status_module &amp;&amp; \
    make -j 2 &amp;&amp; make install &amp;&amp; \
    rm -rf /usr/<span class="hljs-built_in">local</span>/nginx/html/* &amp;&amp; \
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ok&quot;</span> &gt;&gt; /usr/<span class="hljs-built_in">local</span>/nginx/html/status.html &amp;&amp; \
    rm -rf nginx-1.15.5* &amp;&amp; \
    ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime

ENV PATH <span class="hljs-variable">$PATH</span>:/usr/<span class="hljs-built_in">local</span>/nginx/sbin
COPY nginx.conf /usr/<span class="hljs-built_in">local</span>/nginx/conf/nginx.conf
WORKDIR /usr/<span class="hljs-built_in">local</span>/nginx
EXPOSE 80
CMD [<span class="hljs-string">&quot;nginx&quot;</span>, <span class="hljs-string">&quot;-g&quot;</span>, <span class="hljs-string">&quot;daemon off;&quot;</span>]
</code></pre>
<ul>
<li>&#x6784;&#x5EFA;&#x955C;&#x50CF;<pre><code class="lang-bash">docker build -t nginx:v1 Dockerfile-nginx .
</code></pre>
</li>
</ul>
<h3 id="&#x6784;&#x5EFA;tomcat&#x57FA;&#x7840;&#x955C;&#x50CF;"><a name="&#x6784;&#x5EFA;tomcat&#x57FA;&#x7840;&#x955C;&#x50CF;" class="anchor-navigation-ex-anchor" href="#&#x6784;&#x5EFA;tomcat&#x57FA;&#x7840;&#x955C;&#x50CF;"><i class="fa fa-link" aria-hidden="true"></i></a>8.4.3. &#x6784;&#x5EFA;tomcat&#x57FA;&#x7840;&#x955C;&#x50CF;</h3>
<pre><code class="lang-bash">FROM centos:7
LABEL maintainer liqianlong

ENV VERSION=8.5.43

RUN yum install java-1.8.0-openjdk wget curl unzip iproute net-tools -y &amp;&amp; \
    yum clean all &amp;&amp; \
    rm -rf /var/cache/yum/*

RUN wget http://mirror.bit.edu.cn/apache/tomcat/tomcat-8/v<span class="hljs-variable">${VERSION}</span>/bin/apache-tomcat-<span class="hljs-variable">${VERSION}</span>.tar.gz &amp;&amp; \
<span class="hljs-comment"># COPY apache-tomcat-8.5.43.tar.gz /</span>
RUN tar zxf apache-tomcat-<span class="hljs-variable">${VERSION}</span>.tar.gz &amp;&amp; \
    mv apache-tomcat-<span class="hljs-variable">${VERSION}</span> /usr/<span class="hljs-built_in">local</span>/tomcat &amp;&amp; \
    rm -rf apache-tomcat-<span class="hljs-variable">${VERSION}</span>.tar.gz /usr/<span class="hljs-built_in">local</span>/tomcat/webapps/* &amp;&amp; \
    mkdir /usr/<span class="hljs-built_in">local</span>/tomcat/webapps/<span class="hljs-built_in">test</span> &amp;&amp; \
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ok&quot;</span> &gt; /usr/<span class="hljs-built_in">local</span>/tomcat/webapps/<span class="hljs-built_in">test</span>/status.html &amp;&amp; \
    sed -i <span class="hljs-string">&apos;1a JAVA_OPTS=&quot;-Djava.security.egd=file:/dev/./urandom&quot;&apos;</span> /usr/<span class="hljs-built_in">local</span>/tomcat/bin/catalina.sh &amp;&amp; \
    ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime

ENV PATH <span class="hljs-variable">$PATH</span>:/usr/<span class="hljs-built_in">local</span>/tomcat/bin

WORKDIR /usr/<span class="hljs-built_in">local</span>/tomcat

EXPOSE 8080
CMD [<span class="hljs-string">&quot;catalina.sh&quot;</span>, <span class="hljs-string">&quot;run&quot;</span>]
</code></pre>
<ul>
<li>&#x6784;&#x5EFA;&#x955C;&#x50CF;</li>
</ul>
<pre><code class="lang-bash">docker build -t tomcat:v1 Dockerfile-tomcat .
</code></pre>
<h2 id="&#x5FEB;&#x901F;&#x90E8;&#x7F72;lnmp&#x7F51;&#x7AD9;&#x5E73;&#x53F0;"><a name="&#x5FEB;&#x901F;&#x90E8;&#x7F72;lnmp&#x7F51;&#x7AD9;&#x5E73;&#x53F0;" class="anchor-navigation-ex-anchor" href="#&#x5FEB;&#x901F;&#x90E8;&#x7F72;lnmp&#x7F51;&#x7AD9;&#x5E73;&#x53F0;"><i class="fa fa-link" aria-hidden="true"></i></a>8.5. &#x5FEB;&#x901F;&#x90E8;&#x7F72;LNMP&#x7F51;&#x7AD9;&#x5E73;&#x53F0;</h2>
<p><img src="https://www.liqianlong.cn/docker_lnmp.png" alt="image"></p>
<p>1&#x3001; &#x81EA;&#x5B9A;&#x4E49;&#x7F51;&#x7EDC;</p>
<pre><code class="lang-bash">docker network create lnmp
</code></pre>
<p>2&#x3001; &#x521B;&#x5EFA;Mysql&#x5BB9;&#x5668;</p>
<pre><code class="lang-bash">docker container run <span class="hljs-_">-d</span> \
--name lnmp_mysql \
--net lnmp \
--mount <span class="hljs-built_in">type</span>=volume,src=mysql-vol,dst=/var/lib/mysql \
<span class="hljs-_">-e</span> MYSQL_ROOT_PASSWORD=123456 \
<span class="hljs-_">-e</span> MYSQL_DATABASE=wordpress \
mysql:5.7 \
--character-set-server=utf8
</code></pre>
<p>3&#x3001;&#x521B;&#x5EFA;PHP&#x5BB9;&#x5668;</p>
<pre><code class="lang-bash">docker run <span class="hljs-_">-d</span> --name lnmp_php --net lnmp --mount <span class="hljs-built_in">type</span>=volume,src=wwwroot,dst=/wwwroot php:v1
</code></pre>
<p>4&#x3001;&#x521B;&#x5EFA;Nginx&#x5BB9;&#x5668;</p>
<pre><code class="lang-bash">docker run <span class="hljs-_">-d</span> --name lnmp_nginx --net lnmp -p 88:80 --mount <span class="hljs-built_in">type</span>=volume,src=wwwroot,dst=/wwwroot nginx:v1
</code></pre>
<blockquote>
<p>&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;nginx.conf&#x4F20;&#x7ED9;Php&#x89E3;&#x6790;&#x5206;&#x6790;&#x7684;&#x65F6;&#x5019;&#xFF0C;Ip&#x7AEF;&#x53E3;&#x662F;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x7F51;&#x6865;lnmp&#x3002;</p>
</blockquote>
<p>5&#x3001;&#x4EE5;wordpress&#x535A;&#x5BA2;&#x4E3A;&#x4F8B;</p>
<pre><code class="lang-bash">https://cn.wordpress.org/wordpress-4.9.4-zh_CN.tar.gz
&#x89E3;&#x538B;&#x540E;&#x653E;&#x5728;/var/lib/docker/volumes/wwwroot/_data&#x4E0B;&#x3002;
</code></pre>
<blockquote>
<p>&#x8FDE;&#x63A5;mysql&#x8981;&#x7528;&#x5BB9;&#x5668;&#x540D;lnmp_mysql&#xFF0C;&#x800C;&#x4E0D;&#x662F;Ip&#x3002;</p>
</blockquote>
<h1 id="&#x4F01;&#x4E1A;&#x7EA7;&#x955C;&#x50CF;&#x4ED3;&#x5E93;harbor"><a name="&#x4F01;&#x4E1A;&#x7EA7;&#x955C;&#x50CF;&#x4ED3;&#x5E93;harbor" class="anchor-navigation-ex-anchor" href="#&#x4F01;&#x4E1A;&#x7EA7;&#x955C;&#x50CF;&#x4ED3;&#x5E93;harbor"><i class="fa fa-link" aria-hidden="true"></i></a>9. &#x4F01;&#x4E1A;&#x7EA7;&#x955C;&#x50CF;&#x4ED3;&#x5E93;harbor</h1>
<blockquote>
<p>Harbor&#x662F;&#x7531;VMWare&#x516C;&#x53F8;&#x5F00;&#x6E90;&#x7684;&#x5BB9;&#x5668;&#x955C;&#x50CF;&#x4ED3;&#x5E93;&#x3002;&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;Harbor&#x662F;&#x5728;Docker Registry&#x4E0A;&#x8FDB;&#x884C;&#x4E86;&#x76F8;&#x5E94;&#x7684;&#x4F01;&#x4E1A;&#x7EA7;&#x6269;&#x5C55;&#xFF0C;&#x4ECE;&#x800C;&#x83B7;&#x5F97;&#x4E86;&#x66F4;&#x52A0;&#x5E7F;&#x6CDB;&#x7684;&#x5E94;&#x7528;&#xFF0C;&#x8FD9;&#x4E9B;&#x65B0;&#x7684;&#x4F01;&#x4E1A;&#x7EA7;&#x7279;&#x6027;&#x5305;&#x62EC;&#xFF1A;&#x7BA1;&#x7406;&#x7528;&#x6237;&#x754C;&#x9762;&#xFF0C;&#x57FA;&#x4E8E;&#x89D2;&#x8272;&#x7684;&#x8BBF;&#x95EE;&#x63A7;&#x5236; &#xFF0C;AD/LDAP&#x96C6;&#x6210;&#x4EE5;&#x53CA;&#x5BA1;&#x8BA1;&#x65E5;&#x5FD7;&#x7B49;&#xFF0C;&#x8DB3;&#x4EE5;&#x6EE1;&#x8DB3;&#x57FA;&#x672C;&#x4F01;&#x4E1A;&#x9700;&#x6C42;&#x3002;&#x5B98;&#x65B9;&#x5730;&#x5740;:<a href="https://vmware.github.io/harbor/cn/" target="_blank">https://vmware.github.io/harbor/cn/</a></p>
</blockquote>
<table>
<thead>
<tr>
<th><div style="width:130">&#x7EC4;&#x4EF6;<div></div></div></th>
<th>&#x529F;&#x80FD;</th>
</tr>
</thead>
<tbody>
<tr>
<td>harbor-adminserver</td>
<td>&#x914D;&#x7F6E;&#x7BA1;&#x7406;&#x4E2D;&#x5FC3;</td>
</tr>
<tr>
<td>harbor-db</td>
<td>Mysql&#x6570;&#x636E;&#x5E93;</td>
</tr>
<tr>
<td>harbor-jobservice</td>
<td>&#x8D1F;&#x8D23;&#x955C;&#x50CF;&#x590D;&#x5236;</td>
</tr>
<tr>
<td>harbor-log</td>
<td>&#x8BB0;&#x5F55;&#x64CD;&#x4F5C;&#x65E5;&#x5FD7;</td>
</tr>
<tr>
<td>harbor-ui</td>
<td>Web&#x7BA1;&#x7406;&#x9875;&#x9762;&#x548C;AP</td>
</tr>
<tr>
<td>Inginx</td>
<td>&#x524D;&#x7AEF;&#x4EE3;&#x7406;&#xFF0C;&#x8D1F;&#x8D23;&#x524D;&#x7AEF;&#x9875;&#x9762;&#x548C;&#x955C;&#x50CF;&#x4E0A;&#x4F20;/&#x4E0B;&#x8F7D;&#x8F6C;&#x53D1;</td>
</tr>
<tr>
<td>redis</td>
<td>&#x4F1A;&#x8BDD;</td>
</tr>
<tr>
<td>registry</td>
<td>&#x955C;&#x50CF;&#x5B58;&#x50A8;</td>
</tr>
</tbody>
</table>
<h2 id="harbor&#x5B89;&#x88C5;"><a name="harbor&#x5B89;&#x88C5;" class="anchor-navigation-ex-anchor" href="#harbor&#x5B89;&#x88C5;"><i class="fa fa-link" aria-hidden="true"></i></a>9.1. Harbor&#x5B89;&#x88C5;</h2>
<p><code>&#x4E09;&#x79CD;&#x5B89;&#x88C5;&#x65B9;&#x5F0F;</code></p>
<ul>
<li>&#x5728;&#x7EBF;&#x5B89;&#x88C5;&#xFF1A;&#x4ECE;Docker Hub&#x4E0B;&#x8F7D;Harbor&#x76F8;&#x5173;&#x955C;&#x50CF;&#xFF0C;&#x56E0;&#x6B64;&#x5B89;&#x88C5;&#x8F6F;&#x4EF6;&#x5305;&#x975E;&#x5E38;&#x5C0F; </li>
<li>&#x79BB;&#x7EBF;&#x5B89;&#x88C5;&#xFF1A;&#x5B89;&#x88C5;&#x5305;&#x5305;&#x542B;&#x90E8;&#x7F72;&#x7684;&#x76F8;&#x5173;&#x955C;&#x50CF;&#xFF0C;&#x56E0;&#x6B64;&#x5B89;&#x88C5;&#x5305;&#x6BD4;&#x8F83;&#x5927;</li>
<li>OVA&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#xFF1A;&#x5F53;&#x7528;&#x6237;&#x5177;&#x6709;vCenter&#x73AF;&#x5883;&#x65F6;&#xFF0C;&#x4F7F;&#x7528;&#x6B64;&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#xFF0C;&#x5728;&#x90E8;&#x7F72;OVA&#x540E;&#x542F;&#x52A8;Harbor</li>
</ul>
<blockquote>
<p>&#x6CE8;&#x610F;</p>
</blockquote>
<ul>
<li>&#x9700;&#x8981;&#x63D0;&#x524D;&#x5B89;&#x88C5;&#x597D;docker</li>
<li>&#x9700;&#x8981;&#x5B89;&#x88C5;compose</li>
</ul>
<blockquote>
<p>harbor compost&#x4E0B;&#x8F7D;&#x5730;&#x5740;</p>
</blockquote>
<p><code>https://github.com/docker/compose/releases</code></p>
<p><code>https://github.com/goharbor/harbor/releases</code></p>
<pre><code class="lang-bash">tar -zxf harbor-offline-installer-v1.7.5.tgz -C /usr/<span class="hljs-built_in">local</span>/

vi harbor.cfg
hostname = harbor.liqianlong.cn
ui_url_protocol = http
harbor_admin_password = 12345

./prepare
./install.sh

cp docker-compose-Linux-x86_64 /usr/bin/docker-compose
chmod +x /usr/bin/docker-compose
</code></pre>
<blockquote>
<p>&#x65E5;&#x5FD7;</p>
</blockquote>
<p><code>/var/log/harbor</code></p>
<blockquote>
<p>&#x767B;&#x5F55;harbor</p>
</blockquote>
<p><code>&#x4F7F;&#x7528;admin/12345&#x767B;&#x5F55;harbor</code></p>
<h2 id="&#x57FA;&#x672C;&#x4F7F;&#x7528;"><a name="&#x57FA;&#x672C;&#x4F7F;&#x7528;" class="anchor-navigation-ex-anchor" href="#&#x57FA;&#x672C;&#x4F7F;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a>9.2. &#x57FA;&#x672C;&#x4F7F;&#x7528;</h2>
<ul>
<li>&#x914D;&#x7F6E;http&#x955C;&#x50CF;&#x4ED3;&#x5E93;&#x53EF;&#x4FE1;&#x4EFB;
&#x8BBF;&#x95EE;harbor&#x5730;&#x5740;&#x65F6;&#x5019;&#x662F;http&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x4ED3;&#x5E93;&#x4FE1;&#x4EFB;&#xFF0C;&#x5982;&#x679C;&#x662F;https&#x53EF;&#x4EE5;&#x4E0D;&#x7528;&#x3002;</li>
</ul>
<pre><code class="lang-bash">cat /etc/docker/daemon.json 
{
<span class="hljs-string">&quot;registry-mirrors&quot;</span>: [ <span class="hljs-string">&quot;http://f1361db2.m.daocloud.io&quot;</span>],
<span class="hljs-string">&quot;insecure-registries&quot;</span>:[<span class="hljs-string">&quot;harbor.liqianlong.cn&quot;</span>]
}
</code></pre>
<ul>
<li>&#x7ED9;&#x955C;&#x50CF;&#x6253;&#x6807;&#x7B7E;</li>
</ul>
<p><code>docker tag nginx:v1 harbor.liqianlong.com/library/nginx:v1</code></p>
<ul>
<li>&#x767B;&#x5F55;Harbor&#xFF08;&#x63A8;&#x9001;&#x955C;&#x50CF;&#x662F;&#x8981;&#x6C42;&#x8981;&#x767B;&#x5F55;&#xFF09;</li>
</ul>
<p><code>docker login harbor.liqianlong.cn</code></p>
<ul>
<li>&#x63A8;&#x9001;&#x955C;&#x50CF;&#xFF08;&#x4E0A;&#x4F20;&#xFF0C;&#x786E;&#x4FDD;&#x6709;&#x9879;&#x76EE;&#x5DF2;&#x521B;&#x5EFA;&#xFF09;</li>
</ul>
<p><code>docker push harbor.liqianlong.cn/library/nginx:v1</code></p>
<ul>
<li>&#x767B;&#x51FA;Harbor</li>
</ul>
<p><code>docker logout harbor.liqianlong.cn</code></p>
<ul>
<li>&#x62C9;&#x955C;&#x50CF;&#xFF08;&#x4E0B;&#x8F7D;&#xFF0C;&#x516C;&#x5F00;&#x4ED3;&#x5E93;&#x4E0D;&#x9700;&#x8981;&#x767B;&#x5F55;&#xFF09;</li>
</ul>
<p><code>docker pull harbor.liqianlong.cn/library/nginx:v1</code></p>
<h1 id="&#x57FA;&#x4E8E;docker&#x6784;&#x5EFA;&#x4F01;&#x4E1A;jenkins-ci&#x5E73;&#x53F0;"><a name="&#x57FA;&#x4E8E;docker&#x6784;&#x5EFA;&#x4F01;&#x4E1A;jenkins-ci&#x5E73;&#x53F0;" class="anchor-navigation-ex-anchor" href="#&#x57FA;&#x4E8E;docker&#x6784;&#x5EFA;&#x4F01;&#x4E1A;jenkins-ci&#x5E73;&#x53F0;"><i class="fa fa-link" aria-hidden="true"></i></a>10. &#x57FA;&#x4E8E;Docker&#x6784;&#x5EFA;&#x4F01;&#x4E1A;Jenkins CI&#x5E73;&#x53F0;</h1>
<ol>
<li>&#x4EC0;&#x4E48;&#x662F;CI/CD</li>
<li>CI&#x6D41;&#x7A0B;</li>
<li>&#x90E8;&#x7F72;Git&#x4EE3;&#x7801;&#x7248;&#x672C;&#x4ED3;&#x5E93; </li>
<li>&#x4E0A;&#x4F20;Java&#x9879;&#x76EE;&#x4EE3;&#x7801;</li>
<li>&#x90E8;&#x7F72;Harbor&#x955C;&#x50CF;&#x4ED3;&#x5E93; </li>
<li>&#x914D;&#x7F6E;JDK&#x548C;Maven&#x73AF;&#x5883; </li>
<li>&#x5B89;&#x88C5;Jenkins</li>
<li>&#x5B89;&#x88C5;Docker</li>
<li>&#x6784;&#x5EFA;Tomcat&#x57FA;&#x7840;&#x955C;&#x50CF; </li>
<li>&#x6D41;&#x6C34;&#x7EBF;&#x53D1;&#x5E03;&#x6D4B;&#x8BD5;</li>
</ol>
<h2 id="&#x4EC0;&#x4E48;&#x662F;cicd"><a name="&#x4EC0;&#x4E48;&#x662F;cicd" class="anchor-navigation-ex-anchor" href="#&#x4EC0;&#x4E48;&#x662F;cicd"><i class="fa fa-link" aria-hidden="true"></i></a>10.1. &#x4EC0;&#x4E48;&#x662F;CI/CD</h2>
<ul>
<li><p>&#x6301;&#x7EED;&#x96C6;&#x6210;(ContinuousIntegration&#xFF0C;CI):&#x4EE3;&#x7801;&#x5408;&#x5E76;&#x3001;&#x6784;&#x5EFA;&#x3001;&#x90E8;&#x7F72;&#x3001;&#x6D4B;&#x8BD5;&#x90FD;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x4E0D;&#x65AD;&#x5730;&#x6267;&#x884C;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#xFF0C;&#x5E76;&#x5BF9;&#x7ED3;&#x679C;&#x53CD;&#x9988;&#x3002; </p>
</li>
<li><p>&#x6301;&#x7EED;&#x90E8;&#x7F72;(ContinuousDeployment&#xFF0C;CD):&#x90E8;&#x7F72;&#x5230;&#x6D4B;&#x8BD5;&#x73AF;&#x5883;&#x3001;&#x9884;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x3001;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x3002;</p>
</li>
<li><p>&#x6301;&#x7EED;&#x4EA4;&#x4ED8;(Continuous Delivery&#xFF0C;CD):&#x5C06;&#x6700;&#x7EC8;&#x4EA7;&#x54C1;&#x53D1;&#x5E03;&#x5230;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#xFF0C;&#x7ED9;&#x7528;&#x6237;&#x4F7F;&#x7528;&#x3002;</p>
</li>
</ul>
<p><img src="https://www.liqianlong.cn/docker_cicd.png" alt="image"></p>
<p>&#x9AD8;&#x6548;&#x7684;CI/CD&#x73AF;&#x5883;&#x53EF;&#x4EE5;&#x83B7;&#x5F97;: </p>
<ul>
<li>&#x53CA;&#x65F6;&#x53D1;&#x73B0;&#x95EE;&#x9898;</li>
<li>&#x5927;&#x5E45;&#x5EA6;&#x51CF;&#x5C11;&#x6545;&#x969C;&#x7387;</li>
<li>&#x52A0;&#x5FEB;&#x8FED;&#x4EE3;&#x901F;&#x5EA6;</li>
<li>&#x51CF;&#x5C11;&#x65F6;&#x95F4;&#x6210;&#x672C;</li>
</ul>
<h2 id="ci&#x6D41;&#x7A0B;"><a name="ci&#x6D41;&#x7A0B;" class="anchor-navigation-ex-anchor" href="#ci&#x6D41;&#x7A0B;"><i class="fa fa-link" aria-hidden="true"></i></a>10.2. CI&#x6D41;&#x7A0B;</h2>
<p><img src="https://www.liqianlong.cn/docker_cishuoming1.png" alt="image"></p>
<p><img src="https://www.liqianlong.cn/docker_cishuoming2.png" alt="image"></p>
<h2 id="3-10&#x90E8;&#x7F72;"><a name="3-10&#x90E8;&#x7F72;" class="anchor-navigation-ex-anchor" href="#3-10&#x90E8;&#x7F72;"><i class="fa fa-link" aria-hidden="true"></i></a>10.3. 3-10&#x90E8;&#x7F72;</h2>
<ul>
<li>&#x5B9E;&#x9A8C;&#x73AF;&#x5883;</li>
</ul>
<table>
<thead>
<tr>
<th>&#x4E3B;&#x673A;&#x540D;</th>
<th>&#x5B89;&#x88C5;&#x6E05;&#x5355;</th>
</tr>
</thead>
<tbody>
<tr>
<td>10.10.10.20</td>
<td>jenkins+git(&#x5BA2;&#x6237;&#x7AEF;)</td>
</tr>
<tr>
<td>10.10.10.21</td>
<td>harbor+git(&#x670D;&#x52A1;&#x7AEF;)</td>
</tr>
</tbody>
</table>
<blockquote>
<p>10.10.10.21(git&#x670D;&#x52A1;&#x7AEF;)</p>
</blockquote>
<pre><code class="lang-bash">yum install -y git
useradd git
passwd git
su - git
mkdir tomcat-java-demo.git
<span class="hljs-built_in">cd</span> tomcat-java-demo.git/
git --bare init &#x521D;&#x59CB;&#x5316;&#x4ED3;&#x5E93;
</code></pre>
<blockquote>
<p>10.10.10.21(harbor&#x7565;)</p>
<p>10.10.10.20(git&#x5BA2;&#x6237;&#x7AEF;)</p>
</blockquote>
<pre><code class="lang-bash">yum install -y git
ssh-keygen -t rsa
ssh-copy-id git@10.10.10.21
&#x4EE3;&#x7801;&#x6587;&#x4EF6;
git <span class="hljs-built_in">clone</span> https://gitee.com/jokerbj/tomcat-java-demo.git
mv tomcat-java-demo demo
10.10.10.21git&#x670D;&#x52A1;&#x7AEF;&#x4EE3;&#x7801;
git <span class="hljs-built_in">clone</span> git@10.10.10.21:/home/git/tomcat-java-demo.git
mv  demo/* tocamt-java-demo/
<span class="hljs-built_in">cd</span> tocamt-java-demo
git add .
git commit -m <span class="hljs-string">&quot;first commit&quot;</span>
git push origin master
</code></pre>
<h2 id="10101020tomcatmavenjdk&#x5B89;&#x88C5;&#x7565;"><a name="10101020tomcatmavenjdk&#x5B89;&#x88C5;&#x7565;" class="anchor-navigation-ex-anchor" href="#10101020tomcatmavenjdk&#x5B89;&#x88C5;&#x7565;"><i class="fa fa-link" aria-hidden="true"></i></a>10.4. 10.10.10.20(tomcat,maven,jdk&#x5B89;&#x88C5;&#x7565;)</h2>
<h2 id="10101020jenkins&#x5B89;&#x88C5;&#x7565;&#x63D2;&#x4EF6;git-pipeline"><a name="10101020jenkins&#x5B89;&#x88C5;&#x7565;&#x63D2;&#x4EF6;git-pipeline" class="anchor-navigation-ex-anchor" href="#10101020jenkins&#x5B89;&#x88C5;&#x7565;&#x63D2;&#x4EF6;git-pipeline"><i class="fa fa-link" aria-hidden="true"></i></a>10.5. 10.10.10.20(jenkins&#x5B89;&#x88C5;&#x7565;,&#x63D2;&#x4EF6;git pipeline)</h2>
<p>&#x6E05;&#x534E;&#x6E90;
<a href="https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json" target="_blank">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</a></p>
<p>unzip jenkins.war -d /usr/local/tomcat/webapps/ROOT</p>
<h2 id="10101020hosts"><a name="10101020hosts" class="anchor-navigation-ex-anchor" href="#10101020hosts"><i class="fa fa-link" aria-hidden="true"></i></a>10.6. 10.10.10.20(hosts)</h2>
<pre><code class="lang-bash">cat /etc/hosts 
10.10.10.21 harbor.liqianlong.cn
</code></pre>
<h2 id="10101020&#x521B;&#x5EFA;&#x6D41;&#x6C34;&#x7EBF;&#x9879;&#x76EE;"><a name="10101020&#x521B;&#x5EFA;&#x6D41;&#x6C34;&#x7EBF;&#x9879;&#x76EE;" class="anchor-navigation-ex-anchor" href="#10101020&#x521B;&#x5EFA;&#x6D41;&#x6C34;&#x7EBF;&#x9879;&#x76EE;"><i class="fa fa-link" aria-hidden="true"></i></a>10.7. 10.10.10.20&#x521B;&#x5EFA;&#x6D41;&#x6C34;&#x7EBF;&#x9879;&#x76EE;</h2>
<blockquote>
<p>java-hello &#x6784;&#x5EFA;&#x6D4B;&#x8BD5;</p>
</blockquote>
<pre><code>node {
   stage(&apos;git clone&apos;) { 
   }
   stage(&apos;build&apos;) {
   }
   stage(&apos;deploy&apos;) {
   }
}
</code></pre><ul>
<li>pipeline&#x811A;&#x672C;&#x5982;&#x4E0B;</li>
</ul>
<blockquote>
<p>&#x6CE8;&#x610F;&#x4FEE;&#x6539;jdk&#xFF0C;mvn&#x8DEF;&#x5F84;&#xFF0C;harbor&#x5730;&#x5740;</p>
</blockquote>
<pre><code class="lang-bash"><span class="hljs-function"><span class="hljs-title">node</span></span> () {  
   // &#x62C9;&#x53D6;&#x4EE3;&#x7801;
   stage(<span class="hljs-string">&apos;Git Checkout&apos;</span>) { 
        checkout([<span class="hljs-variable">$class</span>: <span class="hljs-string">&apos;GitSCM&apos;</span>, branches: [[name: <span class="hljs-string">&apos;$Branch&apos;</span>]], <span class="hljs-keyword">do</span>GenerateSubmoduleConfigurations: <span class="hljs-literal">false</span>, extensions: [], submoduleC<span class="hljs-built_in">fg</span>: [], userRemoteConfigs: [[credentialsId: <span class="hljs-string">&apos;52e2be15-f2d7-472e-bd6e-41015a26e567&apos;</span>, url: <span class="hljs-string">&apos;git@10.10.10.21:/home/git/tomcat-java-demo.git&apos;</span>]]])
   }
   // &#x4EE3;&#x7801;&#x7F16;&#x8BD1;
   stage(<span class="hljs-string">&apos;Maven Build&apos;</span>) {
        sh <span class="hljs-string">&apos;&apos;</span><span class="hljs-string">&apos;
        export JAVA_HOME=/usr/local/jdk1.8.0_91
        /usr/local/apache-maven-3.5.3/bin/mvn clean package -Dmaven.test.skip=true
        &apos;</span><span class="hljs-string">&apos;&apos;</span>
   }
   // &#x9879;&#x76EE;&#x6253;&#x5305;&#x5230;&#x955C;&#x50CF;&#x5E76;&#x63A8;&#x9001;&#x5230;&#x955C;&#x50CF;&#x4ED3;&#x5E93;
   stage(<span class="hljs-string">&apos;Build and Push Image&apos;</span>) {
        sh <span class="hljs-string">&apos;&apos;</span><span class="hljs-string">&apos;
        REPOSITORY=harbor.liqianlong.cn/library/java-demo:${Branch}
        cat &gt; Dockerfile &lt;&lt; EOF
        FROM harbor.liqianlong.cn/library/tomcat:v1
        LABEL maintainer liqianlong
        RUN rm -fr /usr/local/tomcat/webapps/*
        ADD target/*.war /usr/local/tomcat/webapps/ROOT.war
        EOF

        docker build -t $REPOSITORY .
        docker login harbor.liqianlong.cn -u admin -p 12345
        docker push $REPOSITORY
        &apos;</span><span class="hljs-string">&apos;&apos;</span>
   }
   // &#x90E8;&#x7F72;&#x5230;Docker&#x4E3B;&#x673A;
   stage(<span class="hljs-string">&apos;Deploy to Docker&apos;</span>) {
        sh <span class="hljs-string">&apos;&apos;</span><span class="hljs-string">&apos;
        REPOSITORY=harbor.liqianlong.cn/library/java-demo:${Branch}
        docker comtainer rm -f tomcat-java-demo |true
        docker container run -d --name tomcat-java-demo -p 88:8080 $REPOSITORY
        &apos;</span><span class="hljs-string">&apos;&apos;</span>
   }
}
</code></pre>
<h1 id="jar&#x5305;&#x7684;dockerfile"><a name="jar&#x5305;&#x7684;dockerfile" class="anchor-navigation-ex-anchor" href="#jar&#x5305;&#x7684;dockerfile"><i class="fa fa-link" aria-hidden="true"></i></a>11. Jar&#x5305;&#x7684;Dockerfile</h1>
<pre><code class="lang-bash">FROM java:8-jdk-alpine
LABEL maintainer liqianlong
ENV JAVA_OPTS=<span class="hljs-string">&quot;<span class="hljs-variable">$JAVA_OPTS</span> -Dfile.encoding=UTF8 -Duser.timezone=GMT+08&quot;</span>
RUN  apk add -U tzdata &amp;&amp; \
     ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
COPY ./target/product-service-biz.jar ./
EXPOSE 8010
CMD java -jar <span class="hljs-variable">$JAVA_OPTS</span> /product-service-biz.jar
</code></pre>
<footer class="page-footer"><span class="copyright">FROM liqianlong all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x8BE5;&#x6587;&#x4EF6;&#x4FEE;&#x8BA2;&#x65F6;&#x95F4;&#xFF1A;
2021-03-27 13:08:22
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Kubernetes">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="k8s_jieshao_deploy.html" class="navigation navigation-next " aria-label="Next page: k8s介绍部署">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"docker安装使用","level":"2.1.1","depth":2,"next":{"title":"k8s介绍部署","level":"2.1.2","depth":2,"path":"k8s/k8s_jieshao_deploy.md","ref":"./k8s/k8s_jieshao_deploy.md","articles":[]},"previous":{"title":"Kubernetes","level":"2.1","depth":1,"path":"k8s/README.md","ref":"./k8s/README.md","articles":[{"title":"docker安装使用","level":"2.1.1","depth":2,"path":"k8s/docker_install_use.md","ref":"./k8s/docker_install_use.md","articles":[]},{"title":"k8s介绍部署","level":"2.1.2","depth":2,"path":"k8s/k8s_jieshao_deploy.md","ref":"./k8s/k8s_jieshao_deploy.md","articles":[]},{"title":"kubectl命令行","level":"2.1.3","depth":2,"path":"k8s/k8s_kubectl.md","ref":"./k8s/k8s_kubectl.md","articles":[]},{"title":"k8s入门","level":"2.1.4","depth":2,"path":"k8s/k8s_rumen.md","ref":"./k8s/k8s_rumen.md","articles":[]},{"title":"k8s进阶","level":"2.1.5","depth":2,"path":"k8s/k8s_jinjie.md","ref":"./k8s/k8s_jinjie.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["-sharing","splitter","highlight","search","tbfed-pagefooter","anchor-navigation-ex","-hide-element","copy-code-button","3-ba","favicon"],"styles":{"website":"styles/website.css","ebook":"styles/ebook.css","pdf":"styles/pdf.css","mobi":"styles/mobi.css","epub":"styles/epub.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"FROM liqianlong","modify_label":"该文件修订时间：","modify_format":"YYYY-MM-DD HH:mm:ss"},"splitter":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"family":"sans","size":2,"theme":"white"},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":true},"favicon":{"shortcut":"./gitbook/images/favicon.ico","bookmark":"./gitbook/images/favicon.ico","appleTouch":"./gitbook/images/apple-touch-icon.jpg","appleTouchMore":{"120x120":"./gitbook/images/apple-touch-icon.jpg","180x180":"./gitbook/images/apple-touch-icon.jpg"}},"3-ba":{"configuration":"auto","token":"a966d180803ca8cd07c967d6fdfb8d3f"},"copy-code-button":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"liqianlong","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"liqianlong's book","language":"zh-hans","gitbook":"3.2.3","description":"linux python"},"file":{"path":"k8s/docker_install_use.md","mtime":"2021-03-27T05:08:22.841Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-03-27T05:09:10.118Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-3-ba/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

